function ngetTree(t,e,n){$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+n,success:function(t){var e=strToJson(t);o=JSON.parse(e),AgaciYaz(o,0);var n=document.getElementById("TreeArea");n.innerHTML="",n.appendChild(ulx)}})}function strToJson(t){var e="";for(let a=0;a<t.length;a++){var n=t.charAt(a).trim();","==n&&"]"==t.charAt(a+1).trim()&&(console.log("ebe"),n=""),e+=n}return e}function AgaciYaz(t,e,n="0"){var a=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue;ulx.innerHTML="";var r=document.createElement("ul");r.setAttribute("class","list-group"),r.setAttribute("data-seviye",e),r.setAttribute("id",idA),idA+=1;n=n;n+=e.toString();for(let p=0;p<t.length;p++){var i=document.createElement("li");e<=0&&(e=t[p].RNDM_ID);var o=document.createElement("span");o.setAttribute("name","product_name_"),o.innerHTML=t[p].PRODUCT_NAME,i.setAttribute("data-product_id",t[p].PRODUCT_ID),i.setAttribute("data-IS_VIRTUAL",t[p].IS_VIRTUAL),i.setAttribute("data-PRODUCT_TREE_ID",t[p].PRODUCT_TREE_ID);var d=document.createElement("div"),l=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),u=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),s=inputCreator("text","amount","onchange","console.log(this)","form-control form-control-sm","width:33%",t[p].AMOUNT);d.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end"),"OFF"==a&&1!=t[p].IS_VIRTUAL&&(s.setAttribute("readonly","true"),l.setAttribute("disabled","true"),u.setAttribute("disabled","true")),d.appendChild(s),d.appendChild(l),d.appendChild(u);var c=document.createElement("div");c.setAttribute("style","display:flex"),c.appendChild(o),c.appendChild(d),i.appendChild(c),i.setAttribute("class","list-group-item"),t[p].AGAC.length>0&&i.appendChild(AgaciYaz(t[p].AGAC,t[p].RNDM_ID,n)),r.appendChild(i)}return ulx.appendChild(r),r}function buttonCreator(t,e,n,a,r){var i=document.createElement("button");return i.innerText=r,n.length>0&&i.setAttribute(n,a),i.setAttribute("type","button"),i.setAttribute("class",e),t.length>0&&i.setAttribute("style",t),i}function inputCreator(t,e,n,a,r,i,o){var d=document.createElement("input");return d.setAttribute("type",t),d.setAttribute(n,a),d.setAttribute("class",r),d.setAttribute("style",i),d.setAttribute("value",o),d.setAttribute("name",e),d}function getitem(t){sonEleman=t,console.log(t)}function getDs(){$("#TreeArea").dxTreeList({dataSource:employees,rootValue:-1,keyExpr:"ID",parentIdExpr:"Head_ID",columns:[{dataField:"Title",caption:"Position"},"Full_Name","City","State","Mobile_Phone",{dataField:"Hire_Date",dataType:"date"}],expandedRowKeys:[1],showRowLines:!0,showBorders:!0,columnAutoWidth:!0})}function LoadSettings(){var t=document.createElement("table");for(let o=0;o<ProductDesingSetting.length;o++){var e=document.createElement("tr"),n=document.createElement("td");if("bool"==ProductDesingSetting[o].elementType){var a=document.createElement("div");a.setAttribute("class","custom-control custom-switch");var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("name",ProductDesingSetting[o].paramName),r.setAttribute("id",ProductDesingSetting[o].paramName),r.setAttribute("class","custom-control-input"),"OFF"==ProductDesingSetting[o].paramValue&&r.setAttribute("checked","true"),a.appendChild(r);var i=document.createElement("label");i.setAttribute("class","custom-control-label"),i.setAttribute("for",ProductDesingSetting[o].paramName),a.appendChild(i),n.appendChild(a)}e.appendChild(n);n=document.createElement("td");n.innerText=ProductDesingSetting[o].paramDescripton,e.appendChild(n),t.appendChild(e)}document.getElementById("settingsArea").appendChild(t)}function GetAjaxQuery(type,type_id){var CompanyInfo=new Object,url="/index.cfm?fuseaction=objects.get_qs_info&ajax=1&ajax_box_page=1&isAjax=1",myAjaxConnector=GetAjaxConnector();if(myAjaxConnector&&(data="type_id="+type_id+"&q_type="+type,myAjaxConnector.open("post",url+"&xmlhttp=1",!1),myAjaxConnector.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),myAjaxConnector.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),myAjaxConnector.setRequestHeader("X-Requested-With","XMLHttpRequest"),myAjaxConnector.send(data),4==myAjaxConnector.readyState&&200==myAjaxConnector.status))try{CompanyInfo=eval(myAjaxConnector.responseText.replace(/\u200B/g,""))[0]}catch(t){CompanyInfo=!1}return CompanyInfo}function getParameterByName(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),a=n.exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function OpenBasketProducts(t="",e="5"){var n=_compId,a=_compId,r=_priceCatId,i=_priceCatId;openBoxDraggable("http://erp.metosan.com.tr/index.cfm?fuseaction=objects.emptypopup_list_products_partner&price_cat="+r+"&PRICE_CATID="+i+"&company_id="+n+"&company_name="+a+"&columnsa="+t+"&actType="+e+"&question_id=")}function newDraft(){var t=prompt("Ürün Adı");idA=1e3,console.log("Yeni Taslak");var e=document.createElement("div");e.setAttribute("id","ppidarea");var n=document.createElement("ul");n.setAttribute("id",idA),n.setAttribute("data-is_virtual","1"),n.setAttribute("class","list-group"),idA++,e.appendChild(n);var a=document.getElementById("TreeArea");a.innerHTML="",a.appendChild(e),$("#pnamemain").val(t)}function AddRowItem(t,e,n,a,r,i,o,d,r,l,u){if(console.log(arguments),0==u){var s=document.getElementById("ppidarea").children[0],c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-is_virtual",0),c.setAttribute("data-is_virtual",0),c.setAttribute("class","list-group-item");var p=document.createElement("div");p.setAttribute("style","display:flex");var m=document.createElement("span");m.setAttribute("name","product_name_"),m.innerText=e,p.appendChild(m);var b=document.createElement("div");b.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var A=inputCreator("text","amount","onchange","console.log(this)","form-control form-control-sm","width:33%",1);A.setAttribute("readonly","true");var g=buttonCreator("","btn btn-outline-success","","","+");g.setAttribute("disabled","true");var h=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),C=s.getAttribute("data-is_virtual");1==parseInt(C)&&A.removeAttribute("readonly"),b.appendChild(A),b.appendChild(g),b.appendChild(h),p.appendChild(b),c.appendChild(p),s.appendChild(c)}else{s=document.getElementById(u),c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-is_virtual",0),c.setAttribute("data-is_virtual",0),c.setAttribute("class","list-group-item");p=document.createElement("div");p.setAttribute("style","display:flex");m=document.createElement("span");m.setAttribute("name","product_name_"),m.innerText=e,p.appendChild(m);b=document.createElement("div");b.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");A=inputCreator("text","amount","onchange","console.log(this)","form-control form-control-sm","width:33%",1);A.setAttribute("readonly","true");g=buttonCreator("","btn btn-outline-success","","","+");g.setAttribute("disabled","true");h=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-");b.appendChild(A),b.appendChild(g),b.appendChild(h),p.appendChild(b),c.appendChild(p),s.appendChild(c)}}function AgacGetir(t,e=0){console.log(e),e++;var n=new Array;for(let s=0;s<t.length;s++){var a=t[s].getAttribute("data-product_id");obj=t[s];var r=$(obj).find("input[name='amount']")[0].value,i=$(obj).find("span[name='product_name_']")[0].innerText,o=new Object;o.PRODUCT_ID=a,o.PRODUCT_NAME=i,o.AMOUNT=r,o.AGAC=new Array;var d=t[s].children,l=!1;for(let t=0;t<d.length;t++)if("UL"==d[t].tagName){l=!0;var u=d[t].children}console.log(u),1==l&&(o.AGAC=AgacGetir(u,e)),n.push(o)}return SonAgac.push(n),n}function Kaydet(){var t=document.getElementById("ppidarea"),e=t.children[0].children;SonAgac.splice(0,SonAgac.length),AgacGetir(e),console.log(SonAgac)}function addProdMain(){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_add_vp_project")}function addProdMain_(){var t=document.createElement("li");t.setAttribute("data-product_id",0),t.setAttribute("data-is_virtual",1),t.setAttribute("class","list-group-item");var e=document.createElement("span");e.setAttribute("name","product_name_"),e.innerText=prompt("Ürün Adı");var n=document.createElement("div");n.setAttribute("style","display:flex"),n.appendChild(e);var a=document.createElement("div");a.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("onchange","console.log(this)"),r.setAttribute("class","form-control form-control-sm"),r.setAttribute("style","width:33%"),r.setAttribute("name","amount"),r.setAttribute("value",1),r.setAttribute("readonly","true");var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("class","btn btn-outline-success"),i.setAttribute("onclick","OpenBasketProducts_Pars(this)"),i.innerText="+";var o=document.createElement("button");o.innerText="-",o.setAttribute("onclick","remItem(this)"),o.setAttribute("type","button"),o.setAttribute("class","btn btn-outline-danger");var d=document.createElement("button");d.innerText="VP",d.setAttribute("onclick","addProdSub(this)"),d.setAttribute("type","button"),d.setAttribute("class","btn btn-outline-warning"),a.appendChild(r),a.appendChild(i),a.appendChild(d),a.appendChild(o),n.appendChild(a),t.appendChild(n);var l=document.getElementById("ppidarea").children[0];l.appendChild(t)}function OpenBasketProducts_Pars(t){var e,n=t.parentElement.parentElement.parentElement.children;console.log(n);for(let t=0;t<n.length;t++){var a=n[t];"UL"==a.tagName&&(e=a)}if(console.log(e),null!=e){var r=e.getAttribute("id");OpenBasketProducts(r,"5")}else{var i=document.createElement("ul");i.setAttribute("id",idA),i.setAttribute("data-is_virtual",1),i.setAttribute("class","list-group");n=t.parentElement.parentElement.parentElement;n.appendChild(i),OpenBasketProducts(idA,"5"),idA++}}function addProdSub(t){var e,n=t.parentElement.parentElement.parentElement.children;console.log(n);for(let t=0;t<n.length;t++){var a=n[t];"UL"==a.tagName&&(e=a)}console.log(e);var r=document.createElement("li");r.setAttribute("data-product_id",0),r.setAttribute("data-is_virtual",1),r.setAttribute("class","list-group-item");var i=document.createElement("span");i.setAttribute("name","product_name_"),i.innerText=prompt("Ürün Adı");var o=document.createElement("div");o.setAttribute("style","display:flex"),o.appendChild(i);var d=document.createElement("div");d.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("onchange","console.log(this)"),l.setAttribute("class","form-control form-control-sm"),l.setAttribute("style","width:33%"),l.setAttribute("name","amount"),l.setAttribute("value",1),l.setAttribute("readonly","true");var u=document.createElement("button");u.setAttribute("type","button"),u.setAttribute("class","btn btn-outline-success"),u.setAttribute("onclick","OpenBasketProducts_Pars(this)"),u.innerText="+";var s=document.createElement("button");s.innerText="-",s.setAttribute("onclick","remItem(this)"),s.setAttribute("type","button"),s.setAttribute("class","btn btn-outline-danger");var c=document.createElement("button");c.innerText="VP",c.setAttribute("onclick","addProdSub(this)"),c.setAttribute("type","button"),c.setAttribute("class","btn btn-outline-warning"),d.appendChild(l),d.appendChild(u),d.appendChild(c),d.appendChild(s),o.appendChild(d),r.appendChild(o),null==e?(e=document.createElement("ul"),e.setAttribute("class","list-group"),e.setAttribute("id",idA),idA++,e.appendChild(r),t.parentElement.parentElement.parentElement.appendChild(e)):e.appendChild(r)}function getCats(t,e){console.log(e);var n=!1;if("change"==e.type?t.value.length>3&&(n=!0):"keyup"==e.type&&t.value.length>3&&13==e.keyCode&&(n=!0),n){var a=wrk_query("SELECT * FROM PRODUCT_CAT WHERE PRODUCT_CAT LIKE '%"+t.value+"%' OR HIERARCHY LIKE '%"+t.value+"%'","dsn3");if(a.recordcount>0){var r=document.getElementById("tblCat");$("#tblCat").html(""),r.innerHtml="";for(let t=0;t<a.recordcount;t++){var i=a.PRODUCT_CATID[t],o=a.PRODUCT_CAT[t],d=a.HIERARCHY[t],l=document.createElement("tr"),u=document.createElement("td"),s=document.createElement("a");s.setAttribute("href","javascript://"),s.setAttribute("onclick","setCat("+i+",'"+o+"')"),s.innerText=d,u.appendChild(s),l.appendChild(u);u=document.createElement("td"),s=document.createElement("a");s.setAttribute("href","javascript://"),s.setAttribute("onclick","setCat("+i+",'"+o+"')"),s.innerText=o,u.appendChild(s),l.appendChild(u),r.appendChild(l)}}$("#catRdiv").show(500)}}function setCat(t,e){$("#productCatIdVp").val(t),$("#productCatVp").val(e),$("#catRdiv").hide(500)}var o=new Object,ulx=document.createElement("div");ulx.setAttribute("id","ppidarea");var sonEleman="",_compId,_priceCatId,SonAgac=new Array,idA=1e3,isUpdated=!1;$(document).ready(function(){var t=document.getElementById("wrk_main_layout");t.removeAttribute("class"),t.setAttribute("class","container-fluid"),LoadSettings();var e=getParameterByName("project_id"),n=wrk_query("select COMPANY_ID FROM PRO_PROJECTS WHERE PROJECT_ID="+e,"DSN").COMPANY_ID[0];let a=GetAjaxQuery("CompanyInfo",n);_priceCatId=a.PRICE_LISTS.find(t=>1==t.IS_DEFAULT).PRICE_CATID,_compId=n});