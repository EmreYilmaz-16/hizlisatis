function ngetTree(t,e,a,n,r=1,i="",d="",l="",u=""){if(1==r){var s=0;if(1==e)var c=wrk_query("SELECT PRODUCT_NAME FROM VIRTUAL_PRODUCTS_PRT WHERE VIRTUAL_PRODUCT_ID="+t,"DSN3");else{c=wrk_query("SELECT PRODUCT_NAME,STOCK_ID FROM STOCKS WHERE PRODUCT_ID="+t,"DSN3");s=c.STOCK_ID[0]}d=c.PRODUCT_NAME[0];$("#pnamemain").val(d),$("#vp_id").val(t),$("#is_virtual").val(e),$("#pstage").val(l),$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId+"&stock_id="+s,success:function(e){o=JSON.parse(e),AgaciYaz(o,0,"0",1);var a=document.getElementById("TreeArea");a.innerHTML="",a.appendChild(ulx),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla2(),GercekKontrol(t)}})}else 2==r?$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){o=JSON.parse(t);var e=AgaciYaz_12(o,0,"",0);i.appendChild(e),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla2()}}):3==r?$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){o=JSON.parse(t),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla2()}}):4==r?$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){o=JSON.parse(t);var e=AgaciYaz_12(o,0,"",0);$("#ppidarea").html(""),document.getElementById("ppidarea").appendChild(e),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla2()}}):5==r&&$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){o=JSON.parse(t);var e=AgaciYaz_12(o,0,"",0);document.getElementByIdb(u).appendChild(e),console.log(u),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla2()}})}function patnerEkle(t){}function strToJson(t){console.log(t);var e="";for(let n=0;n<t.length;n++){var a=t.charAt(n).trim();","==a&&"]"==t.charAt(n+1).trim()&&(a=""),e+=a}return console.log(e),e}function AgaciYaz(t,e,a="0",n="1"){var r=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue;ulx.innerHTML="";var i=document.createElement("ul");i.setAttribute("class","list-group"),i.setAttribute("data-is_virtual",n),i.setAttribute("data-seviye",e),i.setAttribute("id",idA),idA+=1;a=a;a+=e.toString();for(let n=0;n<t.length;n++){var o=document.createElement("li");e<=0&&(e=t[n].RNDM_ID);var d=document.createElement("span");d.setAttribute("name","product_name_"),d.setAttribute("style","display:inline-grid");var l=VIRTUAL_PRODUCT_TREE_QUESTIONS.find(e=>e.QUESTION_ID==t[n].QUESTION_ID),u=t[n].DISPLAYNAME;t[n].PRODUCT_NAME;l=null!=l?"<span name='question_name_' style='color:var(--danger)'>("+l.QUESTION+")</span>":"",u=null!=u&&u.length>0?"<span name='display_name_' style='color:var(--success)'>("+u+")</span>":"";var s=makeFiyatSpan(t[n].PRICE,t[n].MONEY,"fiyatimis_"+idB);d.innerHTML=t[n].PRODUCT_NAME+"-"+s+" "+l+" "+u,console.log(t[n]),o.setAttribute("data-product_id",t[n].PRODUCT_ID),o.setAttribute("data-stock_id",t[n].STOCK_ID),o.setAttribute("data-price",t[n].PRICE),o.setAttribute("data-other_money",t[n].MONEY),o.setAttribute("data-discount",t[n].DISCOUNT),o.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),o.setAttribute("data-PRODUCT_TREE_ID",t[n].PRODUCT_TREE_ID),o.setAttribute("data-question_id",t[n].QUESTION_ID),o.setAttribute("data-displayName",t[n].DISPLAYNAME);var c=parseFloat(t[n].PRICE),p=moneyArr.findIndex(e=>e.MONEY==t[n].MONEY),m=1;try{moneyArr[p].RATE2}catch{}m=parseFloat(m);var _=c-c*t[n].DISCOUNT/100,A=_*t[n].AMOUNT*m,b={line:329,PRODUCT_ID:t[n].PRODUCT_ID,STOCK_ID:t[n].STOCK_ID,AMOUNT:t[n].AMOUNT,PRICE:c,MONEY:t[n].MONEY,DISCOUNT:t[n].DISCOUNT,IS_VIRTUAL:t[n].IS_VIRTUAL,PRODUCT_TREE_ID:t[n].PRODUCT_TREE_ID,QUESTION_ID:t[n].QUESTION_ID,DISPLAYNAME:t[n].DISPLAYNAME,RATE2MNY:m,NETTOTAL:A,MNYX:p};console.table(b),o.setAttribute("data-netTotal",A),o.setAttribute("data-idb",idB),idB++;var E=document.createElement("div"),g=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),y=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),C=buttonCreator("","btn btn-outline-info","onclick","LoadTree(this)","Pr"),f=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(t[n].AMOUNT));E.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var v=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");"OFF"==r&&1!=t[n].IS_VIRTUAL&&(f.setAttribute("readonly","true"),g.setAttribute("disabled","true"),v.setAttribute("disabled","true")),E.appendChild(f),E.appendChild(g),E.appendChild(v),E.appendChild(C),E.appendChild(y);var I=document.createElement("div");I.setAttribute("style","display:flex"),I.appendChild(d),I.appendChild(E),o.appendChild(I),o.setAttribute("class","list-group-item"),t[n].AGAC.length>0&&o.appendChild(AgaciYaz(t[n].AGAC,t[n].RNDM_ID,a,t[n].IS_VIRTUAL)),i.appendChild(o)}return ulx.appendChild(i),i}function buttonCreator(t,e,a,n,r){var i=document.createElement("button");return i.innerText=r,a.length>0&&i.setAttribute(a,n),i.setAttribute("type","button"),i.setAttribute("class",e),t.length>0&&i.setAttribute("style",t),i}function inputCreator(t,e,a,n,r,i,o){var d=document.createElement("input");return d.setAttribute("type",t),d.setAttribute(a,n),d.setAttribute("class",r),d.setAttribute("style",i),d.setAttribute("value",o),d.setAttribute("name",e),d}function getitem(t){sonEleman=t}function getDs(){$("#TreeArea").dxTreeList({dataSource:employees,rootValue:-1,keyExpr:"ID",parentIdExpr:"Head_ID",columns:[{dataField:"Title",caption:"Position"},"Full_Name","City","State","Mobile_Phone",{dataField:"Hire_Date",dataType:"date"}],expandedRowKeys:[1],showRowLines:!0,showBorders:!0,columnAutoWidth:!0})}function makeFiyatSpan(t,e,a,n=0){var r="";if(0==n)r="<span id='"+a+"'>"+commaSplit(t)+" "+e+"</span>";else{r=document.createElement("span");r.innerText=t+" "+e,r.id=a}return r}function LoadSettings(){$("#settingsArea").html("");var t=document.createElement("table");for(let o=0;o<ProductDesingSetting.length;o++){var e=document.createElement("tr"),a=document.createElement("td");if("bool"==ProductDesingSetting[o].elementType){var n=document.createElement("div");n.setAttribute("class","custom-control custom-switch"),n.setAttribute("onclick","setSettings(this)"),n.setAttribute("data-paramName",ProductDesingSetting[o].paramName),n.setAttribute("data-paramValue",ProductDesingSetting[o].paramValue);var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("name",ProductDesingSetting[o].paramName),r.setAttribute("id",ProductDesingSetting[o].paramName),r.setAttribute("class","custom-control-input"),"ON"==ProductDesingSetting[o].paramValue&&r.setAttribute("checked","true"),n.appendChild(r);var i=document.createElement("label");i.setAttribute("class","custom-control-label"),i.setAttribute("for",ProductDesingSetting[o].paramName),n.appendChild(i),a.appendChild(n)}e.appendChild(a);a=document.createElement("td");a.innerText=ProductDesingSetting[o].paramDescripton,e.appendChild(a),t.appendChild(e)}document.getElementById("settingsArea").appendChild(t)}function GetAjaxQuery(type,type_id){var CompanyInfo=new Object,url="/index.cfm?fuseaction=objects.get_qs_info&ajax=1&ajax_box_page=1&isAjax=1",myAjaxConnector=GetAjaxConnector();if(myAjaxConnector&&(data="type_id="+type_id+"&q_type="+type,myAjaxConnector.open("post",url+"&xmlhttp=1",!1),myAjaxConnector.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),myAjaxConnector.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),myAjaxConnector.setRequestHeader("X-Requested-With","XMLHttpRequest"),myAjaxConnector.send(data),4==myAjaxConnector.readyState&&200==myAjaxConnector.status))try{CompanyInfo=eval(myAjaxConnector.responseText.replace(/\u200B/g,""))[0]}catch(t){CompanyInfo=!1}return CompanyInfo}function getParameterByName(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),n=a.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function OpenBasketProducts(t="",e="5"){var a=_compId,n=_compId,r=_priceCatId,i=_priceCatId;openBoxDraggable("http://erp.metosan.com.tr/index.cfm?fuseaction=objects.emptypopup_list_products_partner&price_cat="+r+"&PRICE_CATID="+i+"&company_id="+a+"&company_name="+n+"&columnsa="+t+"&actType="+e+"&question_id=")}function newDraft(){var t=prompt("Ürün Adı");if(null==t||0==t.trim().length)return!1;idA=1e3;var e=getParameterByName("project_id"),a="select * from workcube_metosan_1.GetCatParamsPBS where PROJECT_ID="+e,n=wrk_query(a,"dsn3"),r=n.PRODUCT_CATID[0],i=n.PRODUCT_UNIT[0];$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=NewDraft&PRODUCT_NAME="+t+"&PRODUCT_CATID="+r+"&PRODUCT_UNIT="+i+"&PROJECT_ID="+e+"&ddsn3=workcube_metosan_1",success:function(t){getProjectProducts(e)}})}function AddRowItem(t,e,a,n,r,i,o,d,r,l,u,s){if(console.log(arguments),0==u){var c=document.getElementById("ppidarea").children[0],p=document.createElement("li");p.setAttribute("data-product_id",t),p.setAttribute("data-stock_id",n),p.setAttribute("data-is_virtual",0),p.setAttribute("data-price",r),p.setAttribute("data-standart_price",r),p.setAttribute("data-other_money",o),p.setAttribute("data-discount",i),p.setAttribute("class","list-group-item"),p.setAttribute("data-idb",idB);var m=filterNum(s);m=parseFloat(m);var _=moneyArr.findIndex(t=>t.MONEY==o),A=moneyArr[_].RATE2;A=parseFloat(A);var b=r-r*i/100,E=b*A*m,g={line:695,PRODUCT_ID:t,STOCK_ID:n,AMOUNT:m,PRICE:r,MONEY:o,DISCOUNT:i,IS_VIRTUAL:0,PRODUCT_TREE_ID:0,QUESTION_ID:0,DISPLAYNAME:"",RATE2MNY:A,NETTOTAL:E,MNYX:_};console.table(g),p.setAttribute("data-netTotal",E);var y=document.createElement("div");y.setAttribute("style","display:flex");var C=document.createElement("span");C.setAttribute("name","product_name_"),C.setAttribute("style","display:inline-grid");var f=makeFiyatSpan(r,o,"fiyatimis_"+idB,1);C.innerText=e,idB++,y.appendChild(C),y.appendChild(f);var v=document.createElement("div");v.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var I=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(s));I.setAttribute("readonly","true");var T=buttonCreator("","btn btn-outline-success","","","+");T.setAttribute("disabled","true");var h=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),S=c.getAttribute("data-is_virtual");1==parseInt(S)&&I.removeAttribute("readonly");var O=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");v.appendChild(I),v.appendChild(T),v.appendChild(O),v.appendChild(h),y.appendChild(v),p.appendChild(y),c.appendChild(p)}else{c=document.getElementById(u),p=document.createElement("li");p.setAttribute("data-product_id",t),p.setAttribute("data-stock_id",n),p.setAttribute("data-is_virtual",0),p.setAttribute("data-is_virtual",0),p.setAttribute("data-price",r),p.setAttribute("data-other_money",o),p.setAttribute("data-discount",i),p.setAttribute("class","list-group-item"),p.setAttribute("data-idb",idB);m=filterNum(s);m=parseFloat(m);_=moneyArr.findIndex(t=>t.MONEY==o),A=moneyArr[_].RATE2,b=r-r*i/100,E=b*A*m,g={line:784,PRODUCT_ID:t,STOCK_ID:n,AMOUNT:m,PRICE:r,MONEY:o,DISCOUNT:i,IS_VIRTUAL:0,PRODUCT_TREE_ID:0,QUESTION_ID:0,DISPLAYNAME:"",RATE2MNY:A,NETTOTAL:E,MNYX:_};console.table(g),p.setAttribute("data-netTotal",E);y=document.createElement("div");y.setAttribute("style","display:flex");C=document.createElement("span");C.setAttribute("name","product_name_"),C.setAttribute("style","display:inline-grid");f=makeFiyatSpan(r,o,"fiyatimis_"+idB,1);C.innerText=e,C.appendChild(f),idB++,y.appendChild(C);v=document.createElement("div");v.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");I=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(s));I.setAttribute("readonly","true");T=buttonCreator("","btn btn-outline-success","","","+");T.setAttribute("disabled","true");h=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),O=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");v.appendChild(I),v.appendChild(T),v.appendChild(O),v.appendChild(h),y.appendChild(v),p.appendChild(y),c.appendChild(p)}var P=wrk_query("SELECT * FROM PRODUCT_TREE WHERE STOCK_ID="+n,"dsn3");P.recordcount>0&&ngetTree(n,0,"workcube_metosan_1","",2,p),MaliyetHesapla2()}function AddRowItemVirtual(t,e,a,n,r,i,o,d,r,l,u){if(0==u){var s=document.getElementById("ppidarea").children[0],c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-stock_id",n),c.setAttribute("data-is_virtual",1),c.setAttribute("data-price",r),c.setAttribute("data-other_money",o),c.setAttribute("data-discount",i),c.setAttribute("class","list-group-item"),c.setAttribute("data-idb",idB);var p=moneyArr.findIndex(t=>t.MONEY==o),m=moneyArr[p].RATE2MNY,_=r-r*i/100,A=_*m*AMOUNT;c.setAttribute("data-netTotal",A);var b=document.createElement("div");b.setAttribute("style","display:flex");var E=document.createElement("span");E.setAttribute("name","product_name_"),E.setAttribute("style","display:inline-grid");var g=makeFiyatSpan(r,o,"fiyatimis_"+idB);E.innerHtml=e+"-"+g,idB++,b.appendChild(E);var y=document.createElement("div");y.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var C=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(1));C.setAttribute("readonly","true");var f=buttonCreator("","btn btn-outline-success","","","+");f.setAttribute("disabled","true");var v=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),I=s.getAttribute("data-is_virtual");1==parseInt(I)&&C.removeAttribute("readonly");var T=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");y.appendChild(C),y.appendChild(f),y.appendChild(T),y.appendChild(v),b.appendChild(y),c.appendChild(b),s.appendChild(c)}else{s=document.getElementById(u),c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-stock_id",n),c.setAttribute("data-is_virtual",1),c.setAttribute("data-is_virtual",1),c.setAttribute("data-price",r),c.setAttribute("data-other_money",o),c.setAttribute("data-discount",i),c.setAttribute("class","list-group-item"),c.setAttribute("data-idb",idB);p=moneyArr.findIndex(t=>t.MONEY==o),m=moneyArr[p].RATE2MNY,_=r-r*i/100,A=_*m*AMOUNT;c.setAttribute("data-netTotal",A);b=document.createElement("div");b.setAttribute("style","display:flex");E=document.createElement("span");E.setAttribute("name","product_name_"),E.setAttribute("style","display:inline-grid");g=makeFiyatSpan(r,o,"fiyatimis_"+idB);E.innerHtml=e+"-"+g,idB++,b.appendChild(E);y=document.createElement("div");y.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");C=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(1));C.setAttribute("readonly","true");f=buttonCreator("","btn btn-outline-success","","","+");f.setAttribute("disabled","true");v=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),T=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");y.appendChild(C),y.appendChild(f),y.appendChild(T),y.appendChild(v),b.appendChild(y),c.appendChild(b),s.appendChild(c)}var h=wrk_query("SELECT * FROM VIRTUAL_PRODUCT_TREE_PRT WHERE VP_ID="+n,"dsn3");h.recordcount>0&&ngetTree(n,1,"workcube_metosan_1","",2,c),MaliyetHesapla2()}function AgacGetir(t,e=0){e++;var a=new Array;for(let C=0;C<t.length;C++){var n=t[C].getAttribute("data-product_id"),r=t[C].getAttribute("data-stock_id"),i=t[C].getAttribute("data-product_catid"),o=t[C].getAttribute("data-is_virtual"),d=t[C].getAttribute("data-question_id"),l=t[C].getAttribute("data-price"),u=t[C].getAttribute("data-netTotal"),s=t[C].getAttribute("data-other_money"),c=t[C].getAttribute("data-discount"),p=t[C].getAttribute("data-displayName");obj=t[C];var m=$(obj).find("input[name='amount']")[0].value;m=filterNum(commaSplit(m));var _=$(obj).find("span[name='product_name_']")[0].cloneNode(!0);try{_.children[0].remove()}catch{}var A=_.innerText,b=new Object;b.PRODUCT_ID=n,b.PRODUCT_NAME=A,b.AMOUNT=m,b.IS_VIRTUAL=o,b.STOCK_ID=r,b.QUESTION_ID=d,b.PRICE=l,b.NET_TOTAL=u,b.MONEY=s,b.DISCOUNT=c,b.DISPLAY_NAME=p,b.PRODUCT_CATID=null!=i?i:0,b.PRODUCT_TREE=new Array;var E=t[C].children,g=!1;for(let t=0;t<E.length;t++)if("UL"==E[t].tagName){g=!0;var y=E[t].children}1==g&&(b.AGAC=AgacGetir(y,e)),a.push(b)}return SonAgac.push(a),a}function Kaydet(){var t=document.getElementById("ppidarea"),e=t.children[0].children;SonAgac.splice(0,SonAgac.length),AgacGetir(e),UrunKaydet()}function addProdMain(t=0){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_add_vp_project&idb="+t)}function addProdMain_(t,e){var a=document.getElementById("productNameVp").value,n=document.getElementById("productCatIdVp").value,r=document.createElement("li");r.setAttribute("data-product_id",0),r.setAttribute("data-stock_id",0),r.setAttribute("data-is_virtual",1),r.setAttribute("data-price",0),r.setAttribute("data-netTotal",0),r.setAttribute("data-discount",0),r.setAttribute("data-other_money","TL"),r.setAttribute("data-displayName",""),r.setAttribute("data-question_id",""),r.setAttribute("data-sta",0),r.setAttribute("class","list-group-item"),r.setAttribute("data-idb",idB);var i=document.createElement("span");i.setAttribute("name","product_name_"),i.setAttribute("style","display:inline-grid");var o=makeFiyatSpan(0,"TL","fiyatimis_"+idB,1);i.innerText=a,i.appendChild(o),idB++,r.setAttribute("data-product_catid",n);var d=document.createElement("div");d.setAttribute("style","display:flex"),d.appendChild(i);var l=document.createElement("div");l.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("onchange","MaliyetHesapla();"),u.setAttribute("class","form-control form-control-sm"),u.setAttribute("style","width:33%"),u.setAttribute("name","amount"),u.setAttribute("value",commaSplit(1)),u.setAttribute("readonly","true");var s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("class","btn btn-outline-success"),s.setAttribute("onclick","OpenBasketProducts_Pars(this)"),s.innerText="+";var c=document.createElement("button");c.innerText="-",c.setAttribute("onclick","remItem(this)"),c.setAttribute("type","button"),c.setAttribute("class","btn btn-outline-danger");var p=document.createElement("button");p.innerText="VP",p.setAttribute("onclick","addProdSub(this)"),p.setAttribute("type","button"),p.setAttribute("class","btn btn-outline-warning");var m=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q"),_=buttonCreator("","btn btn-outline-info","onclick","LoadTree(this)","Pr");if(l.appendChild(u),l.appendChild(s),l.appendChild(p),l.appendChild(m),l.appendChild(_),l.appendChild(c),d.appendChild(l),r.appendChild(d),0==t){var A=document.getElementById("ppidarea").children[0];A.appendChild(r)}else{var b=document.createElement("ul");b.setAttribute("id",idA),b.setAttribute("data-is_virtual",1),b.setAttribute("class","list-group"),idA++,b.appendChild(r),document.getElementByIdb(t).appendChild(b)}agacGosterEkle(),sortableYap(),MaliyetHesapla2(),closeBoxDraggable(e)}function OpenBasketProducts_Pars(t){var e,a=t.parentElement.parentElement.parentElement.children;for(let t=0;t<a.length;t++){var n=a[t];"UL"==n.tagName&&(e=n)}if(null!=e){var r=e.getAttribute("id");OpenBasketProducts(r,"5")}else{var i=document.createElement("ul");i.setAttribute("id",idA),i.setAttribute("data-is_virtual",1),i.setAttribute("class","list-group");a=t.parentElement.parentElement.parentElement;a.appendChild(i),OpenBasketProducts(idA,"5"),idA++}}function addProdSub(t){var e=t.parentElement.parentElement.parentElement.getAttribute("data-idb");addProdMain(e)}function addProdSub_(t){var e,a=t.parentElement.parentElement.parentElement.children;for(let t=0;t<a.length;t++){var n=a[t];"UL"==n.tagName&&(e=n)}var r=document.createElement("li");r.setAttribute("data-product_id",0),r.setAttribute("data-stock_id",0),r.setAttribute("data-is_virtual",1),r.setAttribute("class","list-group-item"),r.setAttribute("data-idb",idB),idB++;var i=document.createElement("span");i.setAttribute("name","product_name_"),i.setAttribute("style","display:inline-grid"),i.innerText=prompt("Ürün Adı");var o=document.createElement("div");o.setAttribute("style","display:flex"),o.appendChild(i);var d=document.createElement("div");d.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("onchange","MaliyetHesapla();"),l.setAttribute("class","form-control form-control-sm"),l.setAttribute("style","width:33%"),l.setAttribute("name","amount"),l.setAttribute("value",commaSplit(1)),l.setAttribute("readonly","true");var u=document.createElement("button");u.setAttribute("type","button"),u.setAttribute("class","btn btn-outline-success"),u.setAttribute("onclick","OpenBasketProducts_Pars(this)"),u.innerText="+";var s=document.createElement("button");s.innerText="-",s.setAttribute("onclick","remItem(this)"),s.setAttribute("type","button"),s.setAttribute("class","btn btn-outline-danger");var c=document.createElement("button");c.innerText="VP",c.setAttribute("onclick","addProdSub(this)"),c.setAttribute("type","button"),c.setAttribute("class","btn btn-outline-warning");var p=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q"),m=buttonCreator("","btn btn-outline-info","onclick","LoadTree(this)","Pr");d.appendChild(l),d.appendChild(u),d.appendChild(c),d.appendChild(p),d.appendChild(m),d.appendChild(s),o.appendChild(d),r.appendChild(o),null==e?(e=document.createElement("ul"),e.setAttribute("class","list-group"),e.setAttribute("id",idA),idA++,e.appendChild(r),t.parentElement.parentElement.parentElement.appendChild(e)):e.appendChild(r),agacGosterEkle(),sortableYap(),MaliyetHesapla2()}function getCats(t,e){var a=!1;if("change"==e.type?t.value.length>5&&(a=!0):"keyup"==e.type&&13==e.keyCode&&(a=!0),a){var n=wrk_query("SELECT * FROM PRODUCT_CAT WHERE PRODUCT_CAT LIKE '%"+t.value+"%' OR HIERARCHY LIKE '%"+t.value+"%'","dsn3");if(n.recordcount>0){var r=document.getElementById("tblCat");$("#tblCat").html(""),r.innerHtml="";for(let t=0;t<n.recordcount;t++){var i=wrk_query("select * from PRODUCT_CAT where HIERARCHY like '"+n.HIERARCHY[t]+"%' and HIERARCHY <>'"+n.HIERARCHY[t]+"'","dsn3"),o=n.PRODUCT_CATID[t],d=n.PRODUCT_CAT[t],l=n.HIERARCHY[t],u=document.createElement("tr"),s=document.createElement("td"),c=document.createElement("a");0==i.recordcount&&(c.setAttribute("href","javascript://"),c.setAttribute("onclick","setCat("+o+",'"+d+"')")),c.innerText=l,s.appendChild(c),u.appendChild(s);s=document.createElement("td"),c=document.createElement("a");0==i.recordcount&&(c.setAttribute("href","javascript://"),c.setAttribute("onclick","setCat("+o+",'"+d+"')")),c.innerText=d,s.appendChild(c),u.appendChild(s),r.appendChild(u)}}$("#catRdiv").show(500)}}function setCat(t,e){$("#productCatIdVp").val(t),$("#productCatVp").val(e),$("#catRdiv").hide(500)}function loadQuestions(){var t="SELECT QUESTION_ID,QUESTION FROM VIRTUAL_PRODUCT_TREE_QUESTIONS",e=wrk_query(t,"dsn3");$("#saquestion").html("");var a=document.createElement("option");a.setAttribute("value",""),a.innerText="Alternatif Sorusu",document.getElementById("saquestion").appendChild(a);for(let t=0;t<e.recordcount;t++){var n=e.QUESTION_ID[t],r=e.QUESTION[t];a=document.createElement("option");a.setAttribute("value",n),a.innerText=r,document.getElementById("saquestion").appendChild(a)}}function addAltrnativeQ(t,e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_add_alternative_question_pbs")}function saveAlternative(t,e){var a=document.getElementById("questionName").value;$.ajax({url:"/AddOns/Partner/cfc/generalFunctions.cfc?method=saveAlternative&QUESTION_NAME="+a+"&dsn3="+t,success:function(t){closeBoxDraggable(e),loadQuestions()}})}function agacGosterEkle(){var t=$("#ppidarea *ul");for(let r=0;r<t.length;r++){var e=t[r].parentElement;if("LI"==e.tagName){var a=document.createElement("button"),n=document.createElement("i");n.setAttribute("class","icn-md icon-down"),a.setAttribute("class","btn btn-sm btn-link"),a.appendChild(n),a.setAttribute("onclick","$(this.parentElement.parentElement.lastChild).toggle(500)"),e.children[0].prepend(a)}}}function sortableYap(){$("#ppidarea *ul").sortable({connectWith:".list-group",sort:function(t,e){console.log("sort")},start:function(t,e){console.log("start")},stop:function(t,e){console.log("stop")},update:function(t,e){console.log("update")},receive:function(t,e){console.log("receive"),console.log(e.sender[0]),console.log(t.target)}});return!0}function virtuallariYerlestir(){var t=$("#ppidarea *ul");for(let r=0;r<t.length;r++){var e=t[r].parentElement;if("ppidarea"==e.getAttribute("id")){t[r].setAttribute("data-is_virtual","1");var a=$(t[r]).find("input[name='amount']");a.removeAttr("readonly")}else{var n=e.getAttribute("data-is_virtual");if(1==parseInt(n)){t[r].setAttribute("data-is_virtual","1");a=$(t[r]).find("input[name='amount']");a.removeAttr("readonly")}else{a=$(t[r]).find("input[name='amount']");a.attr("readonly","true")}}}}function AgaciYaz_12(t,e,a="0",n="1",r){var i=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue,o=document.createElement("ul");o.setAttribute("class","list-group"),o.setAttribute("data-is_virtual",n),o.setAttribute("data-seviye",e),o.setAttribute("id",idA),idA+=1;a=a;a+=e.toString();for(let n=0;n<t.length;n++){r=document.createElement("li");e<=0&&(e=t[n].RNDM_ID);var d=document.createElement("span");d.setAttribute("name","product_name_"),d.setAttribute("style","display:inline-grid");var l=VIRTUAL_PRODUCT_TREE_QUESTIONS.find(e=>e.QUESTION_ID==t[n].QUESTION_ID),u=t[n].DISPLAYNAME;t[n].PRODUCT_NAME;l=null!=l?"<span name='question_name_' style='color:var(--danger)'>("+l.QUESTION+")</span>":"",u=null!=u&&u.length>0?"<span name='display_name_' style='color:var(--success)'>("+u+")</span>":"";var s=makeFiyatSpan(t[n].PRICE,t[n].MONEY,"fiyatimis_"+idB);d.innerHTML=t[n].PRODUCT_NAME+"-"+s+" "+l+" "+u,r.setAttribute("data-product_id",t[n].PRODUCT_ID),r.setAttribute("data-stock_id",t[n].STOCK_ID),r.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),o.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),r.setAttribute("data-PRODUCT_TREE_ID",t[n].PRODUCT_TREE_ID),r.setAttribute("data-price",t[n].PRICE),r.setAttribute("data-discount",t[n].DISCOUNT),r.setAttribute("data-other_money",t[n].MONEY),r.setAttribute("data-question_id",t[n].QUESTION_ID),r.setAttribute("data-displayName",t[n].DISPLAYNAME),r.setAttribute("data-idb",idB),idB++;var c=document.createElement("div"),p=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),m=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),_=buttonCreator("","btn btn-outline-info","onclick","LoadTree(this)","Pr"),A=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",commaSplit(t[n].AMOUNT));c.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var b=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");"OFF"==i&&1!=t[n].IS_VIRTUAL&&(A.setAttribute("readonly","true"),p.setAttribute("disabled","true"),b.setAttribute("disabled","true")),c.appendChild(A),c.appendChild(p),c.appendChild(b),c.appendChild(_),c.appendChild(m);var E=document.createElement("div");E.setAttribute("style","display:flex"),E.appendChild(d),E.appendChild(c),r.appendChild(E),r.setAttribute("class","list-group-item"),t[n].AGAC.length>0&&r.appendChild(AgaciYaz_12(t[n].AGAC,t[n].RNDM_ID,a,t[n].IS_VIRTUAL)),o.appendChild(r)}return o}function AgaciYaz_13(t,e,a="0",n="1",r){var i=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue,o=document.createElement("ul");o.setAttribute("class","list-group"),o.setAttribute("data-is_virtual",n),o.setAttribute("data-seviye",e),o.setAttribute("id",idA),idA+=1;a=a;a+=e.toString();for(let n=0;n<t.length;n++){r=document.createElement("li");e<=0&&(e=t[n].RNDM_ID);var d=document.createElement("span");d.setAttribute("name","product_name_"),d.setAttribute("style","display:inline-grid");var l=VIRTUAL_PRODUCT_TREE_QUESTIONS.find(e=>e.QUESTION_ID==t[n].QUESTION_ID);t[n].PRODUCT_NAME;l=null!=l?"<span style='color:var(--danger)'>("+l.QUESTION+")</span>":"",d.innerHTML=t[n].PRODUCT_NAME+" "+l,r.setAttribute("data-product_id",t[n].PRODUCT_ID),r.setAttribute("data-stock_id",t[n].STOCK_ID),r.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),o.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),r.setAttribute("data-PRODUCT_TREE_ID",t[n].PRODUCT_TREE_ID),r.setAttribute("data-question_id",t[n].QUESTION_ID),r.setAttribute("data-idb",idB),idB++;var u=document.createElement("div"),s=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),c=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),p=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",t[n].AMOUNT);u.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var m=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");"OFF"==i&&1!=t[n].IS_VIRTUAL&&(p.setAttribute("readonly","true"),s.setAttribute("disabled","true"),m.setAttribute("disabled","true")),u.appendChild(p),u.appendChild(s),u.appendChild(m),u.appendChild(c);var _=document.createElement("div");_.setAttribute("style","display:flex"),_.appendChild(d),_.appendChild(u),r.appendChild(_),r.setAttribute("class","list-group-item"),t[n].AGAC.length>0&&r.appendChild(AgaciYaz_12(t[n].AGAC,t[n].RNDM_ID,a,t[n].IS_VIRTUAL)),o.appendChild(r)}return o}function UrunKaydet(){var t=SonAgac[SonAgac.length-1],e=$("#pnamemain").val(),a=$("#vp_id").val(),n=$("#is_virtual").val(),r=$("#project_id").val(),i=$("#pstage").val(),o=$("#maliyet").val();o=filterNum(o);var d={PRODUCT_NAME:e,PRODUCT_ID:a,IS_VIRTUAL:n,PROJECT_ID:r,PRODUCT_STAGE:i,PRODUCT_TREE:t,PRICE:o,MONEY:"TL",DISCOUNT:0,DISPLAY_NAME:"",AGAC:[],SEVIYE:0};if(d){var l=document.createElement("form");l.target="Map",l.method="POST",l.action="/index.cfm?fuseaction=project.emptypopup_query_save_project_product";var u=document.createElement("input");u.type="hidden",u.name="data",u.value=JSON.stringify(d),l.appendChild(u),document.body.appendChild(l),map=window.open("/index.cfm?fuseaction=project.emptypopup_query_save_project_product","Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?l.submit():alert("You must allow popups for this map to work.")}}function setQuestion(t){var e=t.parentElement.parentElement.parentElement,a=e.getAttribute("data-idb"),n=e.getAttribute("data-question_id"),r=e.getAttribute("data-displayname");null==r&&(r=""),
openBoxDraggable("index.cfm?fuseaction=project.emptypopup_mini_tools&tool_type=alternativeQuestion&idb="+a+"&question_id="+n+"&displayName="+r)}function setAQuestions(t,e,a,n){var r=document.getElementByIdb(t);r.setAttribute("data-question_id",e);var i=$(r).find("span[name='product_name_']")[0],o=document.createElement("span");o.innerText="("+n+")",o.setAttribute("style","color:var(--danger)"),i.appendChild(o),closeBoxDraggable(a)}function setAQuestions2(t,e){var a=document.getElementByIdb(t),n=document.getElementById("aquestion"),r=n.value,i=n.options[n.selectedIndex].text,o=document.getElementById("displayName").value;a.setAttribute("data-question_id",r),a.setAttribute("data-displayName",o);var d=$(a).find("span[name='product_name_']")[0],l=$(a).find("span[name='question_name_']")[0],u=$(a).find("span[name='display_name_']")[0];$(l).remove(),$(u).remove();var s=document.createElement("span");s.innerText="("+i+")",s.setAttribute("name","question_name_"),s.setAttribute("style","color:var(--danger)"),d.appendChild(s);s=document.createElement("span");s.innerText="("+o+") ",s.setAttribute("style","color:var(--success)"),s.setAttribute("name","display_name_"),d.appendChild(s),closeBoxDraggable(e)}function MaliyetHesapla2(){var t=$("#ppidarea *li"),e=0;t.each(function(t,a){var n=a.getAttribute("data-netTotal");e+=parseFloat(n),console.table({satir:1859,tutar:n,TTutar:e})}),e=commaSplit(e),$("#maliyet").val(e)}function MaliyetHesapla(){var t=0,e=$("#ppidarea *li");e.each(function(e,a){console.log(a);var n=$(a).find("input[name='amount']").val();$(a).find("input[name='amount']")[0].value=commaSplit(filterNum(commaSplit(n))),n=filterNum(n);var r=a.getAttribute("data-price"),i=(a.getAttribute("data-netTotal"),a.getAttribute("data-other_money")),o=a.getAttribute("data-discount");null!=r&&0!=r.length||(r=0),null!=i&&0!=i.trim().length||(i="TL"),null!=o&&0!=o.length||(o=0),r=parseFloat(r),o=parseFloat(o),n=parseFloat(n);var d=moneyArr[moneyArr.findIndex(t=>t.MONEY==i)].RATE2;d=parseFloat(d);var l=r-r*o/100,u=l*d*n;a.setAttribute("data-netTotal",u),t+=u});var a=commaSplit(t);$("#maliyet").val(a)}function GercekKontrol(t){var e=getParameterByName("project_id"),a=wrk_query("SELECT COUNT(*) AS OFPOR FROM PBS_OFFER INNER JOIN PBS_OFFER_ROW ON PBS_OFFER_ROW.OFFER_ID=PBS_OFFER.OFFER_ID WHERE PBS_OFFER.PROJECT_ID="+e,"DSN3"),n=a.OFPOR[0];n=parseInt(n),console.log(n);var r=document.getElementById("teklifButton");r.removeAttribute("class"),r.setAttribute("class","btn btn-outline-secondary"),r.innerText="Teklif Ver",r.removeAttribute("disabled");var i=document.getElementById("silButon");return i.removeAttribute("disabled"),a.recordcount>0?($("#relb").show(),n):0}function openRelatedDocuments(t){windowopen("index.cfm?fuseaction=project.emptypopup_related_project_documents&project_id="+t)}function updateStage(t,e){console.log(arguments);var a=document.getElementById("vp_id").value;if(340==parseInt(t.value)){var n=wrk_query("select COUNT(*) as SCOUNT from VIRTUAL_PRODUCTS_PRT where PROJECT_ID ="+e+" AND PRODUCT_STAGE=340","dsn3");if(n.SCOUNT[0]>0)return alert("Onaylanmış Ürünler Var"),!1}$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=updateStage&vp_id="+a+"&psatge="+t.value+"&ddsn3=workcube_metosan_1",success:function(t){getProjectProducts(e)}})}function getProjectProducts(t){$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getProjectProducts&PROJECT_ID="+t+"&ddsn3=workcube_metosan_1",success:function(t){$("#leftMenuProject").html(t)}})}function addToCurrentTree(t,e){AddRowItemVirtual(t,e,"",0,0,0,"TL",0,0,0,0)}function convertToOffer(){var t=document.getElementById("maliyet").value,e=_compId,a=_priceCatId,n=document.getElementById("vp_id").value,r=document.getElementById("project_id").value;t=filterNum(t);var i="select PROJECT_NUMBER+'-'+PROJECT_HEAD as PROJECT_HEAD from workcube_metosan.PRO_PROJECTS where PROJECT_ID="+r,o=wrk_query(i,"dsn"),d=o.PROJECT_HEAD[0],l=$("#ppidarea *li"),u=new Array;for(let t=0;t<l.length;t++){var s=l[t],c=$(s.firstChild).find("span[name='product_name_']").text(),p=$(s.firstChild.lastChild).find("input[name='amount']").val(),m=s.getAttribute("data-product_id"),_=s.getAttribute("data-is_virtual"),A=s.getAttribute("data-price"),b=s.getAttribute("data-money"),E=s.getAttribute("data-discount"),g=getsettingByName("is_show_tree").paramValue,y={product_id:m,isVirtual:_,price:A,money:b,discount:E,productName:c,amount:p};u.push(y)}var C={Maliyet:t,company_id:e,price_catid:a,vp_id:n,project_id:r,project_name:d,stock_id:0,is_show_tree:g,ProductList:u},f=document.createElement("form");f.target="Map",f.method="POST",f.action="/index.cfm?fuseaction=sales.list_pbs_offer&event=add&act=convert&is_from_project=1";var v=document.createElement("input");v.type="hidden",v.name="data",v.value=JSON.stringify(C),f.appendChild(v),document.body.appendChild(f),map=window.open("/index.cfm?fuseaction=sales.list_pbs_offer&event=add&act=convert","Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?f.submit():alert("You must allow popups for this map to work.")}function getsettingByName(t){for(let e=0;e<ProductDesingSetting.length;e++)if(ProductDesingSetting[e].paramName==t)return{paramValue:ProductDesingSetting[e].paramValue,indx:e}}function setSettings(t){var e=t.getAttribute("data-paramName"),a=t.getAttribute("data-paramValue");console.log(e,a);var n="OFF";n="OFF"==a?"ON":"OFF",console.log(n),t.setAttribute("data-paramValue",n);var r=getsettingByName(e).indx;ProductDesingSetting[r].paramValue=n,$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=updateSettings&paramName="+e+"&paramValue="+n+"&ddsn3=workcube_metosan_1",success:function(t){console.log(t)}})}function remVirtualProd(t){console.log(t);var e=document.getElementById("vp_id").value,a=document.getElementById("is_virtual").value;console.log(e),1==parseInt(a)?(document.getElementById("VP_"+e).remove(),$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=DELVP&vp_id="+e+"&ddsn3=workcube_metosan_1",success:function(){}})):alert("Gerçek Ürünü Silemezsiniz !")}function remItem(t){var e=t.parentElement.parentElement.parentElement;$(e).remove()}function OpenSearchVP(t=0,e=4){openBoxDraggable("index.cfm?fuseaction=product.emptypopup_list_virtualproducts&idb="+t+"&type="+e)}function SearchWpT(){var t=document.getElementById("txtKeyword").value,e=document.getElementById("txtKeywordProject").value,a=document.getElementById("PCAT").value,n="ListVP",r=document.getElementById("type").value,i=document.getElementById("idb").value,o=$.get("/index.cfm?fuseaction=project.emptypopup_mini_tools&autoComplete=1",{KeyWord_1:t,KeyWord_2:e,projectCatId:a,tool_type:n,type:r,idb:i});o.done(function(t){$("#resultArea").html(t),$("#working_div_main").remove()})}function LoadTree(t){elek=t;var e=elek.parentElement.parentElement.parentElement.getAttribute("data-price"),a="0",n=elek.parentElement.parentElement.parentElement.getAttribute("data-other_money"),r=elek.parentElement.parentElement.parentElement.getAttribute("data-discount"),i=elek.parentElement.parentElement.parentElement.getAttribute("data-product_id"),o=elek.parentElement.parentElement.parentElement.getAttribute("data-stock_id"),d=elek.parentElement.parentElement.parentElement.getAttribute("data-idb"),l=filterNum(commaSplit(elek.parentElement.getElementsByTagName("input")[0].value));e=e.length>0?parseFloat(e):0,a=a.length>0?parseFloat(a):0,r=r.length>0?parseFloat(r):0,i=i.length>0?parseFloat(i):0,o=o.length>0&&isNumber(o)?parseFloat(o):0,n=n.length>0?n:"TL";var u={Price:e,StandartPrice:a,OtherMoney:n,Discount:r,Pid:i,Sid:o,moneyArr:moneyArr,idb:d,miktar:l};console.table(u);var s=JSON.stringify(u);openBoxDraggable("index.cfm?fuseaction=project.emptypopup_mini_tools&autoComplete=1&tool_type=ShowPrice&Data="+s)}function fiyatHesaplaPoppi(t){if(0==t){var e=document.getElementById("fy_0003").value,a=document.getElementById("fdy_0001").value,n=parseFloat(e)+parseFloat(e)*parseFloat(a)/100;document.getElementById("fy_0002").value=n}else{e=document.getElementById("fy_0001").value,a=document.getElementById("fdy_0001").value,n=parseFloat(e)-parseFloat(e)*parseFloat(a)/100;document.getElementById("fy_0003").value=n}}function SetPrice(t,e){document.getElementById("fy_0001").value;var a=document.getElementById("Omfy_0001").value,n=document.getElementById("fy_0003").value,r=document.getElementById("fdy_0001").value;document.getElementByIdb(t).setAttribute("data-price",n),document.getElementByIdb(t).setAttribute("data-discount",r),document.getElementByIdb(t).setAttribute("data-other_money",a),document.getElementByIdb(t).setAttribute("data-netTotal",n),closeBoxDraggable(e)}function SetPrice2(t,e){document.getElementByIdb(t).setAttribute("data-price",SP_FIYAT_HESAP_SONUC.SP_Fiyat),document.getElementByIdb(t).setAttribute("data-discount",SP_FIYAT_HESAP_SONUC.SP_Discount),document.getElementByIdb(t).setAttribute("data-other_money",SP_FIYAT_HESAP_SONUC.SP_SelectedMoney),document.getElementByIdb(t).setAttribute("data-netTotal",SP_FIYAT_HESAP_SONUC.Sp_Tutar),document.getElementById("fiyatimis_"+t).innerText=commaSplit(SP_FIYAT_HESAP_SONUC.SP_Fiyat)+" "+SP_FIYAT_HESAP_SONUC.SP_SelectedMoney,$(document.getElementByIdb(t)).find("input[name='amount']").val(commaSplit(SP_FIYAT_HESAP_SONUC.SP_Miktar)),console.log(SP_FIYAT_HESAP_SONUC),MaliyetHesapla2(),closeBoxDraggable(e)}function openPriceListPartner(t,e,a,n){var r="";moneyArr.forEach(function(t,e){console.log(t.MONEY),r+=t.MONEY+"="+t.RATE2+"&"});var i="index.cfm?fuseaction=objects.emptypopup_price_history_partner&"+r+"sepet_process_type=-1&product_id="+t+"&stock_id="+e+"&pid="+t+"&product_name=&unit="+a+"&row_id=0&company_id="+n;openBoxDraggable(i)}function openPriceList(t,e,a,n,r,i,o,d,l,u,s,c,p,m,_,A,b,E,g,y,C){var f="&product_id="+e+"&stock_id="+a;$("#company_id_").val()&&(f+="&company_id="+$("#company_id_").val()),0==t?(f+="&tax="+n,f+="&cost="+r,f+="&manuel="+i,f+="&product_name="+o,f+="&stock_code="+d,f+="&brand="+l,f+="&indirim1="+u,f+="&basket_row_departman="+c,f+="&deliver_date="+p,f+="&amount="+m,f+="&unit="+_,f+="&price="+A,f+="&other_money="+b,f+="&price_other="+E,f+="&product_name_other="+g,f+="&detail_info_extra="+y,f+="&row_nettotal="+C):f+="&satir="+t,openBoxDraggable("index.cfm?fuseaction=objects.popup_extra_product_prices"+f)}var o=new Object,SP_FIYAT_HESAP_SONUC,ulx=document.createElement("div");ulx.setAttribute("id","ppidarea");var sonEleman="",_compId,_priceCatId,SonAgac=new Array,idA=1e3,isUpdated=!1,idB=5e3,denemeButon="";$(document).ready(function(){var t=document.getElementById("wrk_main_layout");t.removeAttribute("class"),t.setAttribute("class","container-fluid");var e=getParameterByName("project_id"),a=wrk_query("select COMPANY_ID FROM PRO_PROJECTS WHERE PROJECT_ID="+e,"DSN").COMPANY_ID[0];let n=GetAjaxQuery("CompanyInfo",a);_priceCatId=n.PRICE_LISTS.find(t=>1==t.IS_DEFAULT).PRICE_CATID,_compId=a}),document.getElementByIdb=function(t){var e=t.toString(),a=$("*").find("* [data-idb='"+e+"']")[0];return a};var elek=null;