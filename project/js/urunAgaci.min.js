function ngetTree(t,e,a,n,r=1,i="",l="",d=""){if(console.log(arguments),1==r){n.parentElement.children[0].innerText;$("#pnamemain").val(l),$("#vp_id").val(t),$("#is_virtual").val(e),$("#pstage").val(d),$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){var e=strToJson(t);o=JSON.parse(e),console.log(o),AgaciYaz(o,0,"0",1);var a=document.getElementById("TreeArea");a.innerHTML="",a.appendChild(ulx),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla()}})}else $.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=getTree&product_id="+t+"&isVirtual="+e+"&ddsn3="+a+"&company_id="+_compId+"&price_catid="+_priceCatId,success:function(t){var e=strToJson(t);o=JSON.parse(e),console.log(o),console.log("Buradayım");var a=AgaciYaz_12(o,0,"",0);i.appendChild(a),agacGosterEkle(),sortableYap(),virtuallariYerlestir(),MaliyetHesapla()}})}function patnerEkle(t){console.log(t)}function strToJson(t){var e="";for(let n=0;n<t.length;n++){var a=t.charAt(n).trim();","==a&&"]"==t.charAt(n+1).trim()&&(console.log("ebe"),a=""),e+=a}return e}function AgaciYaz(t,e,a="0",n="1"){console.log("AgaciYaz Virtual="+n);var r=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue;ulx.innerHTML="";var i=document.createElement("ul");i.setAttribute("class","list-group"),i.setAttribute("data-is_virtual",n),i.setAttribute("data-seviye",e),i.setAttribute("id",idA),idA+=1;a=a;a+=e.toString();for(let n=0;n<t.length;n++){var o=document.createElement("li");e<=0&&(e=t[n].RNDM_ID);var l=document.createElement("span");l.setAttribute("name","product_name_");var d=VIRTUAL_PRODUCT_TREE_QUESTIONS.find(e=>e.QUESTION_ID==t[n].QUESTION_ID);t[n].PRODUCT_NAME;d=null!=d?"<span style='color:var(--danger)'>("+d.QUESTION+")</span>":"",l.innerHTML=t[n].PRODUCT_NAME+" "+d,o.setAttribute("data-product_id",t[n].PRODUCT_ID),o.setAttribute("data-stock_id",t[n].STOCK_ID),o.setAttribute("data-price",t[n].PRICE),o.setAttribute("data-other_money",t[n].MONEY),o.setAttribute("data-discount",t[n].DISCOUNT),o.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),o.setAttribute("data-PRODUCT_TREE_ID",t[n].PRODUCT_TREE_ID),o.setAttribute("data-question_id",t[n].QUESTION_ID),o.setAttribute("data-idb",idB),idB++;var u=document.createElement("div"),s=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),c=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),p=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",t[n].AMOUNT);u.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var m=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");"OFF"==r&&1!=t[n].IS_VIRTUAL&&(p.setAttribute("readonly","true"),s.setAttribute("disabled","true"),c.setAttribute("disabled","true"),m.setAttribute("disabled","true")),u.appendChild(p),u.appendChild(s),u.appendChild(m),u.appendChild(c);var b=document.createElement("div");b.setAttribute("style","display:flex"),b.appendChild(l),b.appendChild(u),o.appendChild(b),o.setAttribute("class","list-group-item"),t[n].AGAC.length>0&&o.appendChild(AgaciYaz(t[n].AGAC,t[n].RNDM_ID,a,t[n].IS_VIRTUAL)),i.appendChild(o)}return ulx.appendChild(i),i}function buttonCreator(t,e,a,n,r){var i=document.createElement("button");return i.innerText=r,a.length>0&&i.setAttribute(a,n),i.setAttribute("type","button"),i.setAttribute("class",e),t.length>0&&i.setAttribute("style",t),i}function inputCreator(t,e,a,n,r,i,o){var l=document.createElement("input");return l.setAttribute("type",t),l.setAttribute(a,n),l.setAttribute("class",r),l.setAttribute("style",i),l.setAttribute("value",o),l.setAttribute("name",e),l}function getitem(t){sonEleman=t,console.log(t)}function getDs(){$("#TreeArea").dxTreeList({dataSource:employees,rootValue:-1,keyExpr:"ID",parentIdExpr:"Head_ID",columns:[{dataField:"Title",caption:"Position"},"Full_Name","City","State","Mobile_Phone",{dataField:"Hire_Date",dataType:"date"}],expandedRowKeys:[1],showRowLines:!0,showBorders:!0,columnAutoWidth:!0})}function LoadSettings(){var t=document.createElement("table");for(let o=0;o<ProductDesingSetting.length;o++){var e=document.createElement("tr"),a=document.createElement("td");if("bool"==ProductDesingSetting[o].elementType){var n=document.createElement("div");n.setAttribute("class","custom-control custom-switch");var r=document.createElement("input");r.setAttribute("type","checkbox"),r.setAttribute("name",ProductDesingSetting[o].paramName),r.setAttribute("id",ProductDesingSetting[o].paramName),r.setAttribute("class","custom-control-input"),"OFF"==ProductDesingSetting[o].paramValue&&r.setAttribute("checked","true"),n.appendChild(r);var i=document.createElement("label");i.setAttribute("class","custom-control-label"),i.setAttribute("for",ProductDesingSetting[o].paramName),n.appendChild(i),a.appendChild(n)}e.appendChild(a);a=document.createElement("td");a.innerText=ProductDesingSetting[o].paramDescripton,e.appendChild(a),t.appendChild(e)}document.getElementById("settingsArea").appendChild(t)}function GetAjaxQuery(type,type_id){var CompanyInfo=new Object,url="/index.cfm?fuseaction=objects.get_qs_info&ajax=1&ajax_box_page=1&isAjax=1",myAjaxConnector=GetAjaxConnector();if(myAjaxConnector&&(data="type_id="+type_id+"&q_type="+type,myAjaxConnector.open("post",url+"&xmlhttp=1",!1),myAjaxConnector.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2000 00:00:00 GMT"),myAjaxConnector.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),myAjaxConnector.setRequestHeader("X-Requested-With","XMLHttpRequest"),myAjaxConnector.send(data),4==myAjaxConnector.readyState&&200==myAjaxConnector.status))try{CompanyInfo=eval(myAjaxConnector.responseText.replace(/\u200B/g,""))[0]}catch(t){CompanyInfo=!1}return CompanyInfo}function getParameterByName(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),n=a.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function OpenBasketProducts(t="",e="5"){var a=_compId,n=_compId,r=_priceCatId,i=_priceCatId;openBoxDraggable("http://erp.metosan.com.tr/index.cfm?fuseaction=objects.emptypopup_list_products_partner&price_cat="+r+"&PRICE_CATID="+i+"&company_id="+a+"&company_name="+n+"&columnsa="+t+"&actType="+e+"&question_id=")}function newDraft(){var t=prompt("Ürün Adı");if(console.log(t),null==t||0==t.trim().length)return!1;idA=1e3,console.log("Yeni Taslak");var e=getParameterByName("project_id"),a="select * from workcube_metosan_1.GetCatParamsPBS where PROJECT_ID="+e,n=wrk_query(a,"dsn3"),r=n.PRODUCT_CATID[0],i=n.PRODUCT_UNIT[0];$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=NewDraft&PRODUCT_NAME="+t+"&PRODUCT_CATID="+r+"&PRODUCT_UNIT="+i+"&PROJECT_ID="+e+"&ddsn3=workcube_metosan_1",success:function(t){console.log(t)}})}function AddRowItem(t,e,a,n,r,i,o,l,r,d,u){if(console.log(arguments),0==u){var s=document.getElementById("ppidarea").children[0],c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-stock_id",n),c.setAttribute("data-is_virtual",0),c.setAttribute("data-price",r),c.setAttribute("data-other_money",o),c.setAttribute("data-discount",i),c.setAttribute("class","list-group-item"),c.setAttribute("data-idb",idB),idB++;var p=document.createElement("div");p.setAttribute("style","display:flex");var m=document.createElement("span");m.setAttribute("name","product_name_"),m.innerText=e,p.appendChild(m);var b=document.createElement("div");b.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var A=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",1);A.setAttribute("readonly","true");var g=buttonCreator("","btn btn-outline-success","","","+");g.setAttribute("disabled","true");var _=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),C=s.getAttribute("data-is_virtual");1==parseInt(C)&&A.removeAttribute("readonly");var v=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");b.appendChild(A),b.appendChild(g),b.appendChild(v),b.appendChild(_),p.appendChild(b),c.appendChild(p),s.appendChild(c)}else{s=document.getElementById(u),c=document.createElement("li");c.setAttribute("data-product_id",t),c.setAttribute("data-stock_id",n),c.setAttribute("data-is_virtual",0),c.setAttribute("data-is_virtual",0),c.setAttribute("data-price",r),c.setAttribute("data-other_money",o),c.setAttribute("data-discount",i),c.setAttribute("class","list-group-item"),c.setAttribute("data-idb",idB),idB++;p=document.createElement("div");p.setAttribute("style","display:flex");m=document.createElement("span");m.setAttribute("name","product_name_"),m.innerText=e,p.appendChild(m);b=document.createElement("div");b.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");A=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",1);A.setAttribute("readonly","true");g=buttonCreator("","btn btn-outline-success","","","+");g.setAttribute("disabled","true");_=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),v=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");b.appendChild(A),b.appendChild(g),b.appendChild(v),b.appendChild(_),p.appendChild(b),c.appendChild(p),s.appendChild(c)}var h=wrk_query("SELECT * FROM PRODUCT_TREE WHERE STOCK_ID="+n,"dsn3");console.log(h.recordcount),h.recordcount>0&&ngetTree(n,0,"workcube_metosan_1","",2,c),MaliyetHesapla()}function AgacGetir(t,e=0){console.log(e),e++;var a=new Array;for(let _=0;_<t.length;_++){var n=t[_].getAttribute("data-product_id"),r=t[_].getAttribute("data-stock_id"),i=t[_].getAttribute("data-product_catid"),o=t[_].getAttribute("data-is_virtual"),l=t[_].getAttribute("data-question_id"),d=t[_].getAttribute("data-price"),u=t[_].getAttribute("data-other_money"),s=t[_].getAttribute("data-discount");obj=t[_];var c=$(obj).find("input[name='amount']")[0].value,p=$(obj).find("span[name='product_name_']")[0].innerText,m=new Object;m.PRODUCT_ID=n,m.PRODUCT_NAME=p,m.AMOUNT=c,m.IS_VIRTUAL=o,m.STOCK_ID=r,m.QUESTION_ID=l,m.PRICE=d,m.MONEY=u,m.DISCOUNT=s,m.PRODUCT_CATID=null!=i?i:0,m.PRODUCT_TREE=new Array;var b=t[_].children,A=!1;for(let t=0;t<b.length;t++)if("UL"==b[t].tagName){A=!0;var g=b[t].children}console.log(g),1==A&&(m.AGAC=AgacGetir(g,e)),a.push(m)}return SonAgac.push(a),a}function Kaydet(){var t=document.getElementById("ppidarea"),e=t.children[0].children;SonAgac.splice(0,SonAgac.length),AgacGetir(e),console.log(SonAgac),UrunKaydet()}function addProdMain(t=0){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_add_vp_project&idb="+t)}function addProdMain_(t){var e=document.getElementById("productNameVp").value,a=document.getElementById("productCatIdVp").value,n=document.createElement("li");n.setAttribute("data-product_id",0),n.setAttribute("data-stock_id",0),n.setAttribute("data-is_virtual",1),n.setAttribute("class","list-group-item"),n.setAttribute("data-idb",idB),idB++;var r=document.createElement("span");r.setAttribute("name","product_name_"),r.innerText=e,n.setAttribute("data-product_catid",a);var i=document.createElement("div");i.setAttribute("style","display:flex"),i.appendChild(r);var o=document.createElement("div");o.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var l=document.createElement("input");l.setAttribute("type","text"),l.setAttribute("onchange","MaliyetHesapla();"),l.setAttribute("class","form-control form-control-sm"),l.setAttribute("style","width:33%"),l.setAttribute("name","amount"),l.setAttribute("value",1),l.setAttribute("readonly","true");var d=document.createElement("button");d.setAttribute("type","button"),d.setAttribute("class","btn btn-outline-success"),d.setAttribute("onclick","OpenBasketProducts_Pars(this)"),d.innerText="+";var u=document.createElement("button");u.innerText="-",u.setAttribute("onclick","remItem(this)"),u.setAttribute("type","button"),u.setAttribute("class","btn btn-outline-danger");var s=document.createElement("button");s.innerText="VP",s.setAttribute("onclick","addProdSub(this)"),s.setAttribute("type","button"),s.setAttribute("class","btn btn-outline-warning");var c=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");if(o.appendChild(l),o.appendChild(d),o.appendChild(s),o.appendChild(c),o.appendChild(u),i.appendChild(o),n.appendChild(i),0==t){var p=document.getElementById("ppidarea").children[0];p.appendChild(n)}else{var m=document.createElement("ul");m.setAttribute("id",idA),m.setAttribute("data-is_virtual",1),m.setAttribute("class","list-group"),idA++,m.appendChild(n),document.getElementByIdb(t).appendChild(m)}agacGosterEkle(),sortableYap(),MaliyetHesapla()}function OpenBasketProducts_Pars(t){var e,a=t.parentElement.parentElement.parentElement.children;console.log(a);for(let t=0;t<a.length;t++){var n=a[t];"UL"==n.tagName&&(e=n)}if(console.log(e),null!=e){var r=e.getAttribute("id");OpenBasketProducts(r,"5")}else{var i=document.createElement("ul");i.setAttribute("id",idA),i.setAttribute("data-is_virtual",1),i.setAttribute("class","list-group");a=t.parentElement.parentElement.parentElement;a.appendChild(i),OpenBasketProducts(idA,"5"),idA++}}function addProdSub(t){var e=t.parentElement.parentElement.parentElement.getAttribute("data-idb");addProdMain(e)}function addProdSub_(t){var e,a=t.parentElement.parentElement.parentElement.children;console.log(a);for(let t=0;t<a.length;t++){var n=a[t];"UL"==n.tagName&&(e=n)}console.log(e);var r=document.createElement("li");r.setAttribute("data-product_id",0),r.setAttribute("data-stock_id",0),r.setAttribute("data-is_virtual",1),r.setAttribute("class","list-group-item"),r.setAttribute("data-idb",idB),idB++;var i=document.createElement("span");i.setAttribute("name","product_name_"),i.innerText=prompt("Ürün Adı");var o=document.createElement("div");o.setAttribute("style","display:flex"),o.appendChild(i);var l=document.createElement("div");l.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var d=document.createElement("input");d.setAttribute("type","text"),d.setAttribute("onchange","MaliyetHesapla();"),d.setAttribute("class","form-control form-control-sm"),d.setAttribute("style","width:33%"),d.setAttribute("name","amount"),d.setAttribute("value",1),d.setAttribute("readonly","true");var u=document.createElement("button");u.setAttribute("type","button"),u.setAttribute("class","btn btn-outline-success"),u.setAttribute("onclick","OpenBasketProducts_Pars(this)"),u.innerText="+";var s=document.createElement("button");s.innerText="-",s.setAttribute("onclick","remItem(this)"),s.setAttribute("type","button"),s.setAttribute("class","btn btn-outline-danger");var c=document.createElement("button");c.innerText="VP",c.setAttribute("onclick","addProdSub(this)"),c.setAttribute("type","button"),c.setAttribute("class","btn btn-outline-warning");var p=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");l.appendChild(d),l.appendChild(u),l.appendChild(c),l.appendChild(p),l.appendChild(s),o.appendChild(l),r.appendChild(o),null==e?(e=document.createElement("ul"),e.setAttribute("class","list-group"),e.setAttribute("id",idA),idA++,e.appendChild(r),t.parentElement.parentElement.parentElement.appendChild(e)):e.appendChild(r),agacGosterEkle(),sortableYap(),MaliyetHesapla()}function getCats(t,e){console.log(e);var a=!1;if("change"==e.type?t.value.length>3&&(a=!0):"keyup"==e.type&&t.value.length>3&&13==e.keyCode&&(a=!0),a){var n=wrk_query("SELECT * FROM PRODUCT_CAT WHERE PRODUCT_CAT LIKE '%"+t.value+"%' OR HIERARCHY LIKE '%"+t.value+"%'","dsn3");if(n.recordcount>0){var r=document.getElementById("tblCat");$("#tblCat").html(""),r.innerHtml="";for(let t=0;t<n.recordcount;t++){var i=n.PRODUCT_CATID[t],o=n.PRODUCT_CAT[t],l=n.HIERARCHY[t],d=document.createElement("tr"),u=document.createElement("td"),s=document.createElement("a");s.setAttribute("href","javascript://"),s.setAttribute("onclick","setCat("+i+",'"+o+"')"),s.innerText=l,u.appendChild(s),d.appendChild(u);u=document.createElement("td"),s=document.createElement("a");s.setAttribute("href","javascript://"),s.setAttribute("onclick","setCat("+i+",'"+o+"')"),s.innerText=o,u.appendChild(s),d.appendChild(u),r.appendChild(d)}}$("#catRdiv").show(500)}}function setCat(t,e){$("#productCatIdVp").val(t),$("#productCatVp").val(e),$("#catRdiv").hide(500)}function loadQuestions(){var t="SELECT QUESTION_ID,QUESTION FROM VIRTUAL_PRODUCT_TREE_QUESTIONS",e=wrk_query(t,"dsn3");$("#saquestion").html("");var a=document.createElement("option");a.setAttribute("value",""),a.innerText="Alternatif Sorusu",document.getElementById("saquestion").appendChild(a);for(let t=0;t<e.recordcount;t++){var n=e.QUESTION_ID[t],r=e.QUESTION[t];a=document.createElement("option");a.setAttribute("value",n),a.innerText=r,document.getElementById("saquestion").appendChild(a)}}function addAltrnativeQ(t,e){openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_add_alternative_question_pbs")}function saveAlternative(t,e){var a=document.getElementById("questionName").value;$.ajax({url:"/AddOns/Partner/cfc/generalFunctions.cfc?method=saveAlternative&QUESTION_NAME="+a+"&dsn3="+t,success:function(t){console.log(t),closeBoxDraggable(e),loadQuestions()}})}function agacGosterEkle(){var t=$("#ppidarea *ul");for(let r=0;r<t.length;r++){var e=t[r].parentElement;if(console.log(e.tagName),"LI"==e.tagName){var a=document.createElement("button"),n=document.createElement("i");n.setAttribute("class","icn-md icon-down"),a.setAttribute("class","btn btn-sm btn-link"),a.appendChild(n),a.setAttribute("onclick","$(this.parentElement.parentElement.lastChild).toggle(500)"),console.log(a),e.children[0].prepend(a)}}}function sortableYap(){$("#ppidarea *ul").sortable({connectWith:".list-group",sort:function(t,e){console.log("sort")},start:function(t,e){console.log("start")},stop:function(t,e){console.log("stop")},update:function(t,e){console.log("update")},receive:function(t,e){console.log("receive"),console.log(e.sender[0]),console.log(t.target)}});return!0}function virtuallariYerlestir(){var t=$("#ppidarea *ul");for(let r=0;r<t.length;r++){var e=t[r].parentElement;if("ppidarea"==e.getAttribute("id")){console.log("ek"),t[r].setAttribute("data-is_virtual","1");var a=$(t[r]).find("input[name='amount']");console.log(a),a.removeAttr("readonly")}else{var n=e.getAttribute("data-is_virtual");if(1==parseInt(n)){console.log(n),t[r].setAttribute("data-is_virtual","1");a=$(t[r]).find("input[name='amount']");console.log(a),a.removeAttr("readonly")}else{a=$(t[r]).find("input[name='amount']");console.log(a),a.attr("readonly","true")}}}}function AgaciYaz_12(t,e,a="0",n="1",r){var i=ProductDesingSetting.find(t=>"update_real_product"==t.paramName).paramValue,o=document.createElement("ul");o.setAttribute("class","list-group"),o.setAttribute("data-is_virtual",n),o.setAttribute("data-seviye",e),o.setAttribute("id",idA),idA+=1;a=a;a+=e.toString();for(let n=0;n<t.length;n++){r=document.createElement("li");e<=0&&(e=t[n].RNDM_ID);var l=document.createElement("span");l.setAttribute("name","product_name_");var d=VIRTUAL_PRODUCT_TREE_QUESTIONS.find(e=>e.QUESTION_ID==t[n].QUESTION_ID);t[n].PRODUCT_NAME;d=null!=d?"<span style='color:var(--danger)'>("+d.QUESTION+")</span>":"",l.innerHTML=t[n].PRODUCT_NAME+" "+d,r.setAttribute("data-product_id",t[n].PRODUCT_ID),r.setAttribute("data-stock_id",t[n].STOCK_ID),r.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),o.setAttribute("data-IS_VIRTUAL",t[n].IS_VIRTUAL),r.setAttribute("data-PRODUCT_TREE_ID",t[n].PRODUCT_TREE_ID),r.setAttribute("data-question_id",t[n].QUESTION_ID),r.setAttribute("data-idb",idB),idB++;var u=document.createElement("div"),s=buttonCreator("","btn btn-outline-success","onclick","getitem(this)","+"),c=buttonCreator("","btn btn-outline-danger","onclick","remItem(this)","-"),p=inputCreator("text","amount","onchange","MaliyetHesapla();","form-control form-control-sm","width:33%",t[n].AMOUNT);u.setAttribute("style","display:flex;align-items:baseline;float:right;margin-left:auto;justify-content: flex-end");var m=buttonCreator("","btn btn-outline-primary","onclick","setQuestion(this)","Q");"OFF"==i&&1!=t[n].IS_VIRTUAL&&(p.setAttribute("readonly","true"),s.setAttribute("disabled","true"),c.setAttribute("disabled","true"),m.setAttribute("disabled","true")),u.appendChild(p),u.appendChild(s),u.appendChild(m),u.appendChild(c);var b=document.createElement("div");b.setAttribute("style","display:flex"),b.appendChild(l),b.appendChild(u),r.appendChild(b),r.setAttribute("class","list-group-item"),t[n].AGAC.length>0&&r.appendChild(AgaciYaz_12(t[n].AGAC,t[n].RNDM_ID,a,t[n].IS_VIRTUAL)),o.appendChild(r)}return o}function UrunKaydet(){var t=SonAgac[SonAgac.length-1],e=$("#pnamemain").val(),a=$("#vp_id").val(),n=$("#is_virtual").val(),r=$("#project_id").val(),i=$("#pstage").val(),o={PRODUCT_NAME:e,PRODUCT_ID:a,IS_VIRTUAL:n,PROJECT_ID:r,PRODUCT_STAGE:i,PRODUCT_TREE:t};if(o){var l=document.createElement("form");l.target="Map",l.method="POST",l.action="/index.cfm?fuseaction=project.emptypopup_query_save_project_product";var d=document.createElement("input");d.type="hidden",d.name="data",d.value=JSON.stringify(o),l.appendChild(d),document.body.appendChild(l),map=window.open("/index.cfm?fuseaction=project.emptypopup_query_save_project_product","Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?l.submit():alert("You must allow popups for this map to work.")}}function setQuestion(t){var e=t.parentElement.parentElement.parentElement;console.log(e);var a=e.getAttribute("data-idb");console.log(a),openBoxDraggable("index.cfm?fuseaction=project.emptypopup_mini_tools&tool_type=alternativeQuestion&idb="+a)}function setAQuestions(t,e,a,n){var r=document.getElementByIdb(t);r.setAttribute("data-question_id",e);var i=$(r).find("span[name='product_name_']")[0],o=document.createElement("span");o.innerText="("+n+")",o.setAttribute("style","color:var(--danger)"),i.appendChild(o),closeBoxDraggable(a)}function MaliyetHesapla(){var t=0,e=$("#ppidarea *li");e.each(function(e,a){var n=$(a).find("input[name='amount']").val(),r=a.getAttribute("data-price"),i=a.getAttribute("data-other_money"),o=a.getAttribute("data-discount");null!=r&&0!=r.length||(r=0),null!=i&&0!=i.trim().length||(i="TL"),null!=o&&0!=o.length||(o=0),r=parseFloat(r),o=parseFloat(o),n=parseFloat(n);var l=moneyArr[moneyArr.findIndex(t=>t.MONEY==i)].RATE2;l=parseFloat(l);var d=r-r*o/100,u=d*l*n;console.log(u),t+=u});var a=commaSplit(t);$("#maliyet").val(a)}function updateStage(t,e){var a=document.getElementById("vp_id").value;$.ajax({url:"/AddOns/Partner/project/cfc/product_design.cfc?method=updateStage&vp_id="+a+"&psatge="+t.value+"&ddsn3=workcube_metosan_1",success:function(t){console.log(t)}})}var o=new Object,ulx=document.createElement("div");ulx.setAttribute("id","ppidarea");var sonEleman="",_compId,_priceCatId,SonAgac=new Array,idA=1e3,isUpdated=!1,idB=5e3;$(document).ready(function(){var t=document.getElementById("wrk_main_layout");t.removeAttribute("class"),t.setAttribute("class","container-fluid"),LoadSettings();var e=getParameterByName("project_id"),a=wrk_query("select COMPANY_ID FROM PRO_PROJECTS WHERE PROJECT_ID="+e,"DSN").COMPANY_ID[0];let n=GetAjaxQuery("CompanyInfo",a);_priceCatId=n.PRICE_LISTS.find(t=>1==t.IS_DEFAULT).PRICE_CATID,_compId=a}),document.getElementByIdb=function(t){var e=t.toString(),a=$("*").find("* [data-idb='"+e+"']")[0];return a};