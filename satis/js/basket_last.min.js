var HataArr=[],row_count=0,rwww="",rwwwx="",rwwwxy="",selectedCount=0,rowCount=0,tempProductData="",selectedArr=[],CompanyData={};function openHose(e="",t=""){var r=document.getElementById("company_id").value;openBoxDraggable("index.cfm?fuseaction=product.emptypopup_virtual_main_partner&page=3&id="+e+"&price_catid="+document.getElementById("PRICE_CATID").value+"&comp_id="+r+"&type=1&row_id="+t)}function FindProduct(e,t,r,a,n,i,d,l){var u=t.value,o=t.getAttribute("data-type"),s=document.getElementById(o+"_PId"),c=document.getElementById(o+"_SId"),p=document.getElementById(o+"_lbs"),m=document.getElementById(o+"_Prc"),v=document.getElementById("PRODUCT_CAT"),E=document.getElementById("PRODUCT_CATID"),A=document.getElementById("HIEARCHY");if(console.log(s),console.log(c),console.log(p),console.log(m),console.log(e),13==e.keyCode||"change"==e.type){var y=getProductMultiUse(u,l,d);0!=y.RECORDCOUNT?(s.value=y.PRODUCT.PRODUCT_ID,c.value=y.PRODUCT.STOCK_ID,p.innerText=y.PRODUCT.PRODUCT_NAME,m.value=y.PRODUCT.PRICE,"Tube"==o&&(console.log(y.PRODUCT.REL_CATNAME),v.value=y.PRODUCT.REL_CATNAME,E.value=y.PRODUCT.REL_CATID,A.value=y.PRODUCT.REL_HIERARCHY),CalculateTube()):p.innerText="\xdcr\xfcn Bulunamadı"}}function CalculateTube(){var e=document.getElementById("LRekor_Prc").value,t=document.getElementById("Tube_Prc").value,r=document.getElementById("RRekor_Prc").value,a=document.getElementById("AdditionalProduct_Prc").value,n=document.getElementById("working_Prc").value,i=document.getElementById("Kabuk_Prc").value,d=document.getElementById("LRekor_Qty").value,l=document.getElementById("Tube_Qty").value,u=document.getElementById("RRekor_Qty").value,o=document.getElementById("AdditionalProduct_Qty").value,s=document.getElementById("Kabuk_Qty").value,c=document.getElementById("working_Qty").value,p=document.getElementById("marj").value,m=document.getElementById("maliyet"),v=parseFloat(e)*parseFloat(d)+parseFloat(r)*parseFloat(u)+parseFloat(t)*parseFloat(l)+parseFloat(a)*parseFloat(o);v=v+parseFloat(n)*parseFloat(c)+parseFloat(i)*parseFloat(s),v+=v*parseFloat(p)/100,m.value=commaSplit(v,2)}function calculateTubeRow(e){e.value,CalculateTube()}function saveVirtualTube(e,t){var r=SetName(1),a=$("#TubeForm").serialize();$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=saveVirtualTube",data:a+"&product_name="+r+"&dsn3="+generalParamsSatis.dataSources.dsn3,success:function(e){console.log(e);var r=JSON.parse(e);AddRow(r.PID,"",1,1,r.PRICE,r.NAME,18,0,1,"","TL",r.PRICE,"-5"),closeBoxDraggable(t)}})}function AddRow(e,t,r,a,n,i,d,l,u=0,o="",s="TL",c,p="-6"){rowCount=++row_count,console.log(arguments);var m=$(document).find("input[name=_rd_money]:checked").val(),v=document.getElementById("_hidden_rd_money_"+m).value;console.log(v);var E=document.createElement("tr");E.setAttribute("id","row_"+row_count),E.setAttribute("data-selected","0"),E.setAttribute("data-rc",row_count),E.setAttribute("data-ProductType",u),E.setAttribute("class","sepetRow");var A=document.createElement("td"),y=document.createElement("input");y.setAttribute("name","product_id_"+row_count),y.setAttribute("id","product_id_"+row_count),y.setAttribute("type","hidden"),y.setAttribute("value",e);var I=document.createElement("input");I.setAttribute("name","stock_id_"+row_count),I.setAttribute("id","stock_id_"+row_count),I.setAttribute("type","hidden"),I.setAttribute("value",t);var g=document.createElement("input");g.setAttribute("name","is_virtual_"+row_count),g.setAttribute("id","is_virtual_"+row_count),g.setAttribute("type","hidden"),g.setAttribute("value",r);var b=document.createElement("input");b.setAttribute("name","shelf_code_"+row_count),b.setAttribute("id","shelf_code_"+row_count),b.setAttribute("type","hidden"),b.setAttribute("value",o);var h=document.createElement("input");h.setAttribute("type","checkbox"),h.setAttribute("data-row",row_count),h.setAttribute("onclick","selectrw(this)");var C=document.createElement("span");C.innerText=row_count,C.setAttribute("id","spn_"+row_count),A.appendChild(C),A.appendChild(y),A.appendChild(I),A.appendChild(g),A.appendChild(b),A.appendChild(h),E.appendChild(A);var A=document.createElement("td"),b=document.createElement("input");b.setAttribute("name","product_name_"+row_count),b.setAttribute("id","product_name_"+row_count),b.setAttribute("type","text"),b.setAttribute("style","width:40px"),b.setAttribute("value",i);var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(b),A.appendChild(R),E.appendChild(A);var A=document.createElement("td"),T=document.createElement("input");T.setAttribute("name","amount_"+row_count),T.setAttribute("id","amount_"+row_count),T.setAttribute("type","text"),T.setAttribute("style","width:20px"),T.setAttribute("value",commaSplit(a)),T.setAttribute("onchange","hesapla('price',"+row_count+")");var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(T),A.appendChild(R),E.appendChild(A);var A=document.createElement("td"),P=document.createElement("input");P.setAttribute("name","price_"+row_count),P.setAttribute("id","price_"+row_count),P.setAttribute("type","text"),P.setAttribute("onchange","hesapla('price',"+row_count+")"),P.setAttribute("style","width:30px"),P.setAttribute("value",commaSplit(n));var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(P),A.appendChild(R),E.appendChild(A);var A=document.createElement("td"),w=document.createElement("input");w.setAttribute("name","price_other_"+row_count),w.setAttribute("id","price_other_"+row_count),w.setAttribute("type","text"),w.setAttribute("onchange","hesapla('price_other',"+row_count+")"),w.setAttribute("style","width:30px"),w.setAttribute("value",commaSplit(c));var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(w),A.appendChild(R),E.appendChild(A);var A=document.createElement("td"),f=document.createElement("select");f.setAttribute("name","other_money_"+row_count),f.setAttribute("id","other_money_"+row_count),f.setAttribute("onchange","hesapla('other_money',"+row_count+")");for(let D=0;D<moneyArr.length;D++){let B=moneyArr[D];var O=document.createElement("option");O.setAttribute("value",B.MONEY),O.innerText=B.MONEY,f.appendChild(O)}f.value=s;var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(f),A.appendChild(R),E.appendChild(A);var A=document.createElement("td"),S=document.createElement("input");S.setAttribute("name","row_nettotal_"+row_count),S.setAttribute("id","row_nettotal_"+row_count),S.setAttribute("type","text");var _=parseFloat(filterNum(n))*a;S.setAttribute("value",commaSplit(_));var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(S);var U=document.createElement("span");U.setAttribute("class","icon-search"),U.setAttribute("onclick","showData(this)"),U.setAttribute("data-row",row_count),R.appendChild(U),A.appendChild(R),E.appendChild(A);var A=document.createElement("td");A.setAttribute("style","display:none"),A.setAttribute("class","hiddenR");var k=document.createElement("input");k.setAttribute("name","Tax_"+row_count),k.setAttribute("id","Tax_"+row_count),k.setAttribute("value",commaSplit(d));var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(k),A.appendChild(R),E.appendChild(A);var A=document.createElement("td");A.setAttribute("style","display:none"),A.setAttribute("class","hiddenR");var x=document.createElement("input");x.setAttribute("name","indirim1_"+row_count),x.setAttribute("id","indirim1_"+row_count),x.setAttribute("value",commaSplit(l));var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(x),A.appendChild(R),E.appendChild(A);var A=document.createElement("td");A.setAttribute("style","display:none"),A.setAttribute("class","hiddenR");var H=document.createElement("select");H.setAttribute("name","orderrow_currency_"+row_count),H.setAttribute("id","orderrow_currency_"+row_count);var N=document.createElement("option");N.setAttribute("value",-5),N.innerText="\xdcretim",H.appendChild(N);var N=document.createElement("option");N.setAttribute("value",-6),N.innerText="Sevk",H.appendChild(N);var N=document.createElement("option");N.setAttribute("value",-2),N.innerText="Tedarik",H.appendChild(N);var N=document.createElement("option");N.setAttribute("value",-10),N.innerText="Kapatıldı",H.appendChild(N),H.value=p;var R=document.createElement("div");R.setAttribute("class","form-group"),R.appendChild(H),A.appendChild(R),E.appendChild(A),document.getElementById("tbl_basket").appendChild(E),hesapla("price",rowCount),RowControlForVirtual()}function selectRow(e){0==parseInt((rwww=e).getAttribute("data-selected"))?(rwww.setAttribute("style","background-color:#ffaaaa80"),rwww.setAttribute("data-selected","1"),selectedCount++):(rwww.setAttribute("style","background-color:white"),rwww.setAttribute("data-selected","0"),selectedCount--)}function getProductMultiUse(e,t,r){var a,n={};return!function i(d){if(a=!1,window.XMLHttpRequest)try{a=new XMLHttpRequest}catch(l){a=!1}else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(u){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){a=!1}}a&&(a.open("post",d+"&xmlhttp=1",!1),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("pragma","nocache"),a.send("keyword="+e+"&userid="+generalParamsSatis.userData.user_id+"&dsn2="+generalParamsSatis.dataSources.dsn2+"&dsn1="+generalParamsSatis.dataSources.dsn1+"&dsn3="+generalParamsSatis.dataSources.dsn3+"&price_catid="+r+"&comp_id="+t),console.log(a),4==a.readyState&&200==a.status&&(JSON.parse(a.responseText.replace(/\u200B/g,"")),n=JSON.parse(a.responseText.replace(/\u200B/g,""))))}("/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=getProduct"),n}function getProductAjx(e,t,r){var a="";return $.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=getProduct",data:{keyword:e,userid:generalParamsSatis.userData.user_id,dsn2:generalParamsSatis.dataSources.dsn2,dsn1:generalParamsSatis.dataSources.dsn1,dsn3:generalParamsSatis.dataSources.dsn3,price_catid:r,comp_id:t}}).done(function(e){a=e,console.log(a)}),a}function getProductWithBarcode(e,t,r,a,n,i){var d=t.value;console.log(e);var l=document.getElementById("company_id").value,u=document.getElementById("PRICE_CATID").value;if(13==e.keyCode||"change"==e.type||"*"==e.key){"*"==e.key&&(d=d.slice(0,d.length-1));var o=getProductMultiUse(d,l,u);if(console.log(o),0!=o.RECORDCOUNT){var s="SELECT PP.SHELF_CODE  FROM PRODUCT_PLACE_ROWS AS PPR";s+=" LEFT JOIN PRODUCT_PLACE AS PP ON PP.PRODUCT_PLACE_ID=PPR.PRODUCT_PLACE_ID";var c=wrk_query(s+=" WHERE STOCK_ID="+o.PRODUCT.STOCK_ID,"dsn3");if(console.log(c),c.recordcount>1){var p="";for(let m=0;m<c.recordcount;m++)p+=c.SHELF_CODE[m]+"\n";var v=prompt("Raf Kodu \n"+p)}else var v=c.SHELF_CODE[0];ShelfControl(o.PRODUCT.PRODUCT_ID,v)&&AddRow(o.PRODUCT.PRODUCT_ID,o.PRODUCT.STOCK_ID,0,1,parseFloat(o.PRODUCT.PRICE).toString(),o.PRODUCT.PRODUCT_NAME,o.PRODUCT.TAX,o.PRODUCT.DISCOUNT_RATE,0,v,o.PRODUCT.MONEY,parseFloat(o.PRODUCT.PRICE).toString(),-6),t.value=""}else alert("\xdcr\xfcn Bulunamadı")}}function ShelfControl(e,t){var r="select DISTINCT SHELF_CODE,PPR.PRODUCT_PLACE_ID,PPR.PRODUCT_ID,PP.STORE_ID,PP.LOCATION_ID,PPR.PRODUCT_ID,SL.DEPARTMENT_LOCATION from "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE_ROWS AS PPR";return r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE AS PP ON PP.PRODUCT_PLACE_ID=PPR.PRODUCT_PLACE_ID ",r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn+".STOCKS_LOCATION AS SL ON  SL.LOCATION_ID=PP.LOCATION_ID AND SL.DEPARTMENT_ID=PP.STORE_ID ",0!=wrk_query(r+="WHERE PPR.PRODUCT_ID="+e+" AND SHELF_CODE='"+t+"'","dsn3").recordcount||(0==generalParamsSatis.workingParams.IS_RAFSIZ?(alert("\xdcr\xfcn Bu Rafta Tanımlı Değildir Veya Raf Kodu Bulunamamıştır"),!1):(alert("\xdcr\xfcn Bu Rafta Tanımlı Değildir Veya Raf Kodu Bulunamamıştır Rafsız Kayıt Yapılacaktır"),!0))}function selectrw(e){if($(rwwwx=e).is(":checked")){var t=rwwwx.getAttribute("data-row"),r=document.getElementById("row_"+t);r.setAttribute("style","background-color:#aaefff80"),r.setAttribute("data-selected",1)}else{var t=rwwwx.getAttribute("data-row"),r=document.getElementById("row_"+t);r.setAttribute("style","background-color:#fff"),r.setAttribute("data-selected",0)}BasketSelControl()}function BasketSelControl(){selectedArr.splice(0,selectedArr.length);var e=document.getElementById("UpdateButtonCell"),t=document.getElementById("RemoveButtonCell"),r=document.getElementById("TubeGroupButtonCell");$(e).hide(),$(t).hide(),$(r).hide();var a=document.getElementsByClassName("sepetRow");for(let n=0;n<a.length;n++){var i=a[n],d=i.getAttribute("data-selected");console.log(d),1==parseInt(d)&&selectedArr.push(i)}if(1==selectedArr.length){var l=selectedArr[0],u=l.getAttribute("data-rc"),o=l.getAttribute("data-producttype"),s=$(l).find("#is_virtual_"+u).val(),c=$(l).find("#product_id_"+u).val();if(1==parseInt(s)){var p=document.getElementById("UpdateRow");1==parseInt(o)?p.setAttribute("onclick","openHose("+c+","+u+")"):2==parseInt(o)&&p.setAttribute("onclick","openHydrolic("+c+","+u+",1)"),$(e).show()}}$(t).show()}function showData(e){rwwwxy=e;var t=e.getAttribute("data-row"),r=document.getElementById("product_name_"+t).value,a=document.getElementById("Tax_"+t).value,n=document.getElementById("indirim1_"+t).value;openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_showdata_prt&rowid="+t+"&p_name="+r+"&tax="+a+"&disc="+n)}function saveRowExtra(e,t){var r=document.getElementById("row_extra_tax_tax").value,a=document.getElementById("row_extra_disc").value;document.getElementById("Tax_"+e).value=commaSplit(r),document.getElementById("indirim1_"+e).value=commaSplit(a),hesapla("price",e),closeBoxDraggable(t)}function hesapla(e,t){var r=filterNum($("#price_"+t).val(),8),a=filterNum($("#price_other_"+t).val(),8),n=filterNum($("#amount_"+t).val(),8),i=filterNum($("#indirim1_"+t).val(),8),d=$("#other_money_"+t).val(),l=filterNum($("#_txt_rate1_"+$("input[id^='_hidden_rd_money_'][value='"+d+"']").prop("id").split("_")[4]).val(),8),u=filterNum($("#_txt_rate2_"+$("input[id^='_hidden_rd_money_'][value='"+d+"']").prop("id").split("_")[4]).val(),8);$("#qs_basket tbody tr[data-rc='"+t+"']").css("background-color","white"),list_find("price,other_money",e)?a=r*l/u:"price_other"==e&&(r=a*u/l);var o=r*(100-i)/100*n;$("#price_other_"+t).val(commaSplit(a,4)),$("#price_"+t).val(commaSplit(r,4)),$("#row_nettotal_"+t).val(commaSplit(o,4)),$("#amount_"+t).val(commaSplit(n,2)),toplamHesapla()}function toplamHesapla(){var e=0,t=0,r=0,a=0;for(let n=1;n<=rowCount;n++)if($("#price_"+n).val()){let i=filterNum($("#price_"+n).val(),8);filterNum($("#price_other_"+n).val(),8),filterNum($("#amount_"+n).val(),8),filterNum($("#indirim1_"+n).val(),8);let d=$("#Tax_"+n).val(),l=$("#other_money_"+n).val(),u=filterNum($("#row_nettotal_"+n).val(),8);filterNum($("#_txt_rate1_"+$("input[id^='_hidden_rd_money_'][value='"+l+"']").prop("id").split("_")[4]).val(),8),filterNum($("#_txt_rate2_"+$("input[id^='_hidden_rd_money_'][value='"+l+"']").prop("id").split("_")[4]).val(),8),e+=parseFloat(i),t+=parseFloat(u),r+=parseFloat(u)*(parseInt(d)/100),a+=parseFloat(u)*(1+parseInt(d)/100)}$("#subTotal").val(commaSplit(t,4)),$("#subTaxTotal").val(commaSplit(r,4)),$("#subWTax").val(commaSplit(a,4))}function GetShelves(e){$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=getProductShelves",data:{dsn3:generalParamsSatis.dataSources.dsn3,dsn:generalParamsSatis.dataSources.dsn,product_id:e,success:function(e){console.log(e)}}})}function UpdVirtualTube(e,t){var r=$("#TubeForm").serialize();$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=UpdVirtualTube",data:r+"&dsn3="+generalParamsSatis.dataSources.dsn3,success:function(e){console.log(e);var r=JSON.parse(e);UpdRow(r.PID,"",1,1,r.PRICE,r.NAME,18,0,r.ROW_ID),closeBoxDraggable(t)}})}function UpdRow(e,t,r,a,n,i,d,l,u){$("#product_id_"+u).val(e),$("#stock_id_"+u).val(t),$("#is_virtual_"+u).val(r),$("#amount_"+u).val(a),$("#price_"+u).val(n),$("#product_name_"+u).val(i),$("#Tax_"+u).val(d),$("#indirim1_"+u).val(l),hesapla("price",u)}function RemSelected(){for(let e=0;e<selectedArr.length;e++)$(selectedArr[e]).remove();selectedArr.splice(0,selectedArr.length),rowArrange()}function rowArrange(){var e=document.getElementsByClassName("sepetRow");for(let t=0;t<e.length;t++){var r=t+1,a=e[t],n=a.getAttribute("data-rc");console.log(n),a.setAttribute("id","row_"+r),a.setAttribute("data-selected","0"),a.setAttribute("data-rc",r);var i=document.getElementById("product_name_"+n);i.setAttribute("id","product_name_"+r),i.setAttribute("name","product_name_"+r);var d=document.getElementById("product_id_"+n);d.setAttribute("id","product_id_"+r),d.setAttribute("name","product_id_"+r);var l=document.getElementById("stock_id_"+n);l.setAttribute("id","stock_id_"+r),l.setAttribute("name","stock_id_"+r);var u=document.getElementById("is_virtual_"+n);u.setAttribute("id","is_virtual_"+r),u.setAttribute("name","is_virtual_"+r);var o=document.getElementById("amount_"+n);o.setAttribute("id","amount_"+r),o.setAttribute("name","amount_"+r);var s=document.getElementById("price_"+n);s.setAttribute("id","price_"+r),s.setAttribute("name","price_"+r);var c=document.getElementById("price_other_"+n);c.setAttribute("id","other_money_"+r),c.setAttribute("name","other_money_"+r);var p=document.getElementById("row_nettotal_"+n);p.setAttribute("id","row_nettotal_"+r),p.setAttribute("name","row_nettotal_"+r);var m=document.getElementById("shelf_code_"+n);m.setAttribute("id","shelf_code_"+r),m.setAttribute("name","shelf_code_"+r);var v=document.getElementById("orderrow_currency_"+n);v.setAttribute("id","orderrow_currency_"+r),v.setAttribute("name","orderrow_currency_"+r),$(a).find(".icon-search")[0].setAttribute("data-row",r);var E=document.getElementById("Tax_"+n);E.setAttribute("id","Tax_"+r),E.setAttribute("name","Tax_"+r);var A=document.getElementById("indirim1_"+n);A.setAttribute("id","indirim1_"+r),A.setAttribute("name","indirim1_"+r)}row_count=e.length,rowCount=e.length}function SaveTube(e,t,r=0){var a="";if(0==r){var a=window.prompt("\xdcr\xfcn Adı");a.length>0||SaveTube(e,t)}if(TubeControl()){var n=$("#TubeForm").serialize();$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=saveTube",data:n+"&product_name="+a+"&dsn3="+generalParamsSatis.dataSources.dsn3+"&dsn1="+generalParamsSatis.dataSources.dsn1+"&dsn="+generalParamsSatis.dataSources.dsn,success:function(e){console.log(e);var r=JSON.parse(e);r.ROW_ID.length>0?UpdRow(r.PID,r.SID,0,1,r.PRICE,r.NAME,18,0,r.ROW_ID):AddRow(r.PID,r.SID,0,1,r.PRICE,r.NAME,18,0,1,"","TL",r.PRICE,"-5"),closeBoxDraggable(t)}})}}function TubeControl(){HataArr=[];var e=document.getElementById("LRekor_PId").value,t=document.getElementById("Tube_PId").value,r=document.getElementById("RRekor_PId").value,a=document.getElementById("AdditionalProduct_PId").value,n=document.getElementById("working_PId").value,i=document.getElementById("Kabuk_PId").value;console.log(e),console.log(t),console.log(r),console.log(a),console.log(n),console.log(i);var d=generalParamsSatis.Questions.find(e=>1==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&(0==parseInt(e)||0==e.length)&&HataArr.push("Sol Rekor Se\xe7mediniz !");var d=generalParamsSatis.Questions.find(e=>2==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&(0==parseInt(t)||0==t.length)&&HataArr.push("Hortum Se\xe7mediniz !");var d=generalParamsSatis.Questions.find(e=>3==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&(0==parseInt(r)||0==r.length)&&HataArr.push("Sağ Rekor Se\xe7mediniz !");var d=generalParamsSatis.Questions.find(e=>4==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&0==parseInt(a||0==a.length)&&HataArr.push("Ek İşlem Se\xe7iniz !");var d=generalParamsSatis.Questions.find(e=>5==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&(0==parseInt(i)||0==i.length)&&HataArr.push("Kabuk Se\xe7mediniz !");var d=generalParamsSatis.Questions.find(e=>6==e.QUESTION_ID);console.log(d),1==d.IS_REQUIRED&&(0==parseInt(n)||0==n.length)&&HataArr.push("İş\xe7ilik Se\xe7iniz !");var l=JSON.stringify(HataArr);return!(HataArr.length>0)||(openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_partner_testpage&page=6&data="+l,"small"),!1)}function HataGosterClick(e,t){1==t&&closeBoxDraggable(e)}function openHydrolic(e="",t="",r=0){var a,n=document.getElementById("company_id").value;openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_partner_testpage&page=3&id="+e+"&price_catid="+document.getElementById("PRICE_CATID").value+"&comp_id="+n+"&type=2&row_id="+t)}function findHydrolic(e,t){var r=t.value,a=document.getElementById("company_id").value,n=document.getElementById("PRICE_CATID").value;if(13==e.keyCode){var i=getProductMultiUse(r,a,n);if(0!=i.RECORDCOUNT){var d=$("#tblBaskHyd").find("input[value="+i.PRODUCT.PRODUCT_ID+"]").parent().parent();if(0!=d.length){if(0==generalParamsSatis.workingParams.IS_ADD_QUANTITY)addHydrolicRow(i);else if("Adet"==i.PRODUCT.MAIN_UNIT){var l=d.attr("data-row"),e=parseFloat(filterNum(d.find("#quantity_"+l).val()));e++,d.find("#quantity_"+l).val(commaSplit(e))}else addHydrolicRow(i)}else addHydrolicRow(i);CalculatehydrolicRow(hydRowCount)}t.value="",$(t).focus()}}function addHydrolicRow(e){hydRowCount++;var t=document.getElementById("tblBaskHyd"),r=document.createElement("tr");r.setAttribute("data-row",hydRowCount),r.setAttribute("id","hydRow"+hydRowCount);var a=document.createElement("td"),n=document.createElement("i");n.setAttribute("class","icn-md icon-minus"),n.setAttribute("onclick","removeRow(this,"+hydRowCount+")"),a.innerText=hydRowCount,r.appendChild(a);var a=document.createElement("td"),i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","product_id_"+hydRowCount),i.setAttribute("id","product_id_"+hydRowCount),i.setAttribute("value",e.PRODUCT.PRODUCT_ID),a.appendChild(i);var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","stock_id_"+hydRowCount),i.setAttribute("id","stock_id_id_"+hydRowCount),i.setAttribute("value",e.PRODUCT.STOCK_ID),a.appendChild(i);var d=document.createElement("div");d.setAttribute("class","form-group");var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("name","product_name_"+hydRowCount),i.setAttribute("id","product_name_"+hydRowCount),i.setAttribute("value",e.PRODUCT.PRODUCT_NAME),i.setAttribute("readonly","true"),d.appendChild(i),a.appendChild(d),r.appendChild(a);var d=document.createElement("div");d.setAttribute("class","form-group");var a=document.createElement("td");a.setAttribute("style","width:10%");var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("name","quantity_"+hydRowCount),i.setAttribute("id","quantity_"+hydRowCount),i.setAttribute("value",commaSplit(1)),i.setAttribute("class","prtMoneyBox"),i.setAttribute("onchange","CalculatehydrolicRow("+hydRowCount+")"),d.appendChild(i),a.appendChild(d),r.appendChild(a);var a=document.createElement("td");a.setAttribute("style","width:15%");var i=document.createElement("input"),d=document.createElement("div");d.setAttribute("class","form-group"),i.setAttribute("type","text"),i.setAttribute("name","price_"+hydRowCount),i.setAttribute("class","prtMoneyBox"),i.setAttribute("id","price_"+hydRowCount),i.setAttribute("onchange","CalculatehydrolicRow("+hydRowCount+")"),i.setAttribute("value",commaSplit(e.PRODUCT.PRICE)),d.appendChild(i),a.appendChild(d),r.appendChild(a);var a=document.createElement("td");a.setAttribute("style","width:10%");var i=document.createElement("input"),d=document.createElement("div");d.setAttribute("class","form-group"),i.setAttribute("type","text"),i.setAttribute("readonly","true"),i.setAttribute("class","prtMoneyBox"),i.setAttribute("name","money_"+hydRowCount),i.setAttribute("id","money_"+hydRowCount),i.setAttribute("value",e.PRODUCT.MONEY),d.appendChild(i),a.appendChild(d),r.appendChild(a);var a=document.createElement("td");a.setAttribute("style","width:17%");var i=document.createElement("input"),d=document.createElement("div");d.setAttribute("class","form-group"),i.setAttribute("type","text"),i.setAttribute("readonly","true"),i.setAttribute("name","netT_"+hydRowCount),i.setAttribute("id","netT_"+hydRowCount),i.setAttribute("class","prtMoneyBox"),i.setAttribute("value",e.PRODUCT.PRICE),d.appendChild(i),a.appendChild(d),r.appendChild(a),t.appendChild(r)}function saveVirtualHydrolic(e){var t=SetName(2);$("#hydRwc").val(hydRowCount),$("#hydProductName").val(t);var r=getFormData($("#HydrolicForm"));$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=saveVirtualHydrolic",data:r,success:function(t){var r=JSON.parse(t);AddRow(r.PID,"",1,1,r.PRICE,r.NAME,18,0,2,"","TL",r.PRICE),closeBoxDraggable(e)}})}function UpdateVirtualHydrolic(e){$("#hydRwc").val(hydRowCount);var t=getFormData($("#HydrolicForm"));$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=updateVirtualHydrolic",data:t,success:function(t){var r=JSON.parse(t);UpdRow(r.PID,"",1,1,r.PRICE,r.NAME,18,0,r.ROW_ID),closeBoxDraggable(e)}})}function saveRealHydrolic(e){$("#hydRwc").val(hydRowCount);var t=getFormData($("#HydrolicForm"));$.ajax({url:"/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=SaveRealHydrolic",data:t,success:function(t){var r=JSON.parse(t);UpdRow(r.PID,"",1,1,r.PRICE,r.NAME,18,0,r.ROW_ID),closeBoxDraggable(e)}})}function getFormData(e){var t=e.serializeArray(),r={};return $.map(t,function(e,t){r[e.name]=e.value}),r}function CalculatehydrolicRow(e){var t=$("input[name=_rd_money]:checked").val(),r=document.getElementById("_hidden_rd_money_"+t).value,a=moneyArr.find(e=>e.MONEY==r).RATE2;console.log("RATE2="+parseFloat(a));var n=document.getElementById("quantity_"+e).value,i=document.getElementById("price_"+e).value,d=document.getElementById("money_"+e).value;moneyArr.filter(e=>e.MONEY==d),console.log(l);var l=parseFloat(filterNum(n))*parseFloat(filterNum(i));document.getElementById("quantity_"+e).value=commaSplit(filterNum(n)),document.getElementById("price_"+e).value=commaSplit(filterNum(i)),console.log(l),document.getElementById("netT_"+e).value=commaSplit(l),CalculateHydSub()}function CalculateHydSub(){var e=0,t=document.getElementById("marjHyd").value;document.getElementById("marjHyd").value=commaSplit(t),t=filterNum(t),t=parseFloat(t);for(let r=1;r<=hydRowCount;r++){var a=document.getElementById("netT_"+r).value,n=document.getElementById("money_"+r).value,i=moneyArr.filter(e=>e.MONEY==n);e+=parseFloat(filterNum(a))*i[0].RATE2}e+=e*t/100,$("#hydSubTotal").val(commaSplit(e))}function SetName(e,t="\xdcr\xfcn Adı",r=""){let a=r;if(1==generalParamsSatis.workingParams.IS_RANDOM_UNIQE_NAME){var n=parseInt((new Date-1)/1e6);1==e&&(a="Hortum-"+n),2==e&&(a="Hidrolik-"+n)}else if((a=prompt(t,r)).trim().length>0){if(0==generalParamsSatis.workingParams.IS_SAME_VIRTUAL_NAME)for(;;){var i=wrk_query("SELECT * FROM VIRTUAL_PRODUCTS_PRT WHERE PRODUCT_NAME='"+(a=prompt("\xdcr\xfcn Adı Kullanılmıştır \n \xdcr\xfcn Adı:"))+"'","dsn3");if(0==i.recordcount)break}}else{for(;0==a.length;)null!=(a=prompt("\xdcr\xfcn Adı Boş Olamaz \n \xdcr\xfcn Adı:"))?console.warn("ok"):a="";if(0==generalParamsSatis.workingParams.IS_SAME_VIRTUAL_NAME)for(;;){var i=wrk_query("SELECT * FROM VIRTUAL_PRODUCTS_PRT WHERE PRODUCT_NAME='"+(a=prompt("\xdcr\xfcn Adı Kullanılmıştır \n \xdcr\xfcn Adı:"))+"'","dsn3");if(0==i.recordcount)break}}return a}function saveOrder(){var e=document.getElementsByClassName("sepetRow"),t=[];for(let r=1;r<=e.length;r++){var a,n=document.getElementById("product_name_"+r).value,i=document.getElementById("product_id_"+r).value,d=document.getElementById("stock_id_"+r).value,l=document.getElementById("is_virtual_"+r).value,u=document.getElementById("amount_"+r).value,o=document.getElementById("price_"+r).value,s=document.getElementById("other_money_"+r).value,c=document.getElementById("row_nettotal_"+r).value,p=document.getElementById("shelf_code_"+r).value,m=document.getElementById("Tax_"+r).value,v=document.getElementById("indirim1_"+r).value,E={product_name:n,product_id:i,stock_id:d,is_virtual:l,amount:u,price:o,other_money:s,row_nettotal:c,shelf_code:p,Tax:m,indirim1:v,price_other:document.getElementById("price_other_"+r).value,orderrow_currency:document.getElementById("orderrow_currency_"+r).value};t.push(E)}var A=document.getElementById("company_id").value,y=document.getElementById("company_name").value,I=document.getElementById("PAYMETHOD").value,g=document.getElementById("PAYMETHOD_ID").value,b=document.getElementById("VADE").value,h=document.getElementById("company_partner_name").value,C=document.getElementById("company_partner_id").value,R=document.getElementById("process_stage").value,T=document.getElementById("SHIP_METHOD").value,P=document.getElementById("SHIP_METHOD_ID").value,w=document.getElementById("order_id").value,f=document.getElementById("subTotal").value,D=document.getElementById("subTaxTotal").value,B=document.getElementById("subWTax").value,O=document.getElementById("offer_date").value,S=document.getElementById("offer_head").value,_=document.getElementById("ship_address").value,U=document.getElementById("ship_address_id").value,k=document.getElementById("city_id").value,x=document.getElementById("county_id").value;f=filterNum(f,4),D=filterNum(D,4),B=filterNum(B,4);var H=$(document).find("input[name=_rd_money]:checked").val(),N="";$("#snl_teklif").is(":checked")&&(N+="1,"),$("#siparis").is(":checked")&&(N+="2,"),$("#sevkiyat").is(":checked")&&(N+="3,"),$("#sales_type_1").is(":checked")&&(N+="4,");var M=document.getElementById("_hidden_rd_money_"+H).value,L=document.getElementById("_txt_rate1_"+H).value,F=document.getElementById("_txt_rate2_"+H).value,Q=filterNum(L,4),K=filterNum(F,4),Y={COMPANY_ID:A,PAYMETHOD:I,PAYMETHOD_ID:g,VADE:b,COMPANY_PARTNER_NAME:h,COMPANY_PARTNER_ID:C,MEMBER_NAME:y,PROCESS_STAGE:R,SHIP_METHOD:T,SHIP_METHOD_ID:P,ORDER_ID:w,OFFER_DATE:O,OFFER_HEAD:S,SHIP_ADDRESS:_,SHIP_ADDRESS_ID:U,CITY_ID:k,COUNTY_ID:x,ISLEM_TIPI_PBS:N},z={SUBTOTAL:f,SUBTAXTOTAL:D,SUBNETTOTAL:B,BASKET_MONEY:M,BASKET_RATE_1:Q,BASKET_RATE_2:K},V={OrderHeader:Y,OrderRows:t,OrderMoney:moneyArr,OrderFooter:z,WORKING_PARAMS:generalParamsSatis.workingParams},j=document.createElement("form");j.target="Map",j.method="POST",j.action="/index.cfm?fuseaction=sales.emptypopup_query_save_order";var W=document.createElement("input");W.type="hidden",W.name="data",W.value=JSON.stringify(V),j.appendChild(W),document.body.appendChild(j),(map=window.open("/index.cfm?fuseaction=sales.emptypopup_query_save_order","Map","status=0,title=0,height=600,width=800,scrollbars=1"))?j.submit():alert("You must allow popups for this map to work.")}function RowControlForVirtual(){var e=document.getElementsByClassName("sepetRow"),t=!1;for(let r=1;r<=e.length;r++){var a=document.getElementById("is_virtual_"+r);console.log(a.value),1==parseInt(a.value)&&(t=!0)}t&&(document.getElementById("siparis").setAttribute("disabled","true"),document.getElementById("sevkiyat").setAttribute("disabled","true"),$(document.getElementById("snl_teklif")).click())}function pencere_ac_product(e){}$(document).ready(function(){$("#barcode").focus(),RowControlForVirtual();var e=getParameterByName("event");console.log(e),"add"==e&&1==generalParamsSatis.workingParams.IS_ALL_SEVK&&(document.getElementById("sales_type_1").setAttribute("checked","true"),document.getElementById("sevkiyat").setAttribute("checked","true"),document.getElementById("siparis").setAttribute("checked","true"),document.getElementById("snl_teklif").setAttribute("checked","true"),$("#sales_type_m").show())});