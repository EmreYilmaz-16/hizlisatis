function setDoom(){$(".ui-form-list-btn").parent().hide(),$("#basketArea").find(".ui-scroll").attr("style","height:"+50*window.innerHeight/100+"px;max"),$("#scrollbarProject").attr("style","margin-bottom:0;overflow-y:hidden"),document.body.addEventListener("click",hideP),0==generalParamsSatis.workingParams.SHOW_HYDROLIC&&$("#hydBtn").hide(),0==generalParamsSatis.workingParams.SHOW_PUMP&&$("#pumpBtn").hide(),0==generalParamsSatis.workingParams.SHOW_TUBE&&$("#hoseBtn").hide(),0==generalParamsSatis.workingParams.SHOW_VIRTUAL_PRODUCT&&$("#vpBtn").hide(),FiyatTalepKontrol(0)}function hideP(){$(".pbsContex").remove()}function AddRow(t,e,r,a,n,i,o,d,u,l,c=0,s="",_="TL",m,p="-6",A=0,E=0,v="Adet",b="",C="",I=0,y="",h="",T=0,P="",w="",g="",D=0,S=0,O=0,f=0){if(1==O)return getKarmaProducts(t,i),!1;console.log(arguments);var R=$(document),N=R.find("input[name=_rd_money]:checked").val();document.getElementById("_hidden_rd_money_"+N).value;if(0==f&&"M"==v&&0==I){var B="&pid_="+t+"&sid_="+e+"&tax="+u+"&cost="+E+"&manuel="+A+"&product_name="+d+"&stock_code="+r+"&brand="+a+"&indirim1="+l+"&amount="+i+"&unit="+v+"&price="+o+"&other_money="+_+"&price_other="+m;return B+="&is_virtual="+n,B+="&product_type="+c,B+="&shelf_code="+s,B+="&rowNum="+row_count,openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_extra_calculate_pbs"+B),!0}var x="SELECT PP.SHELF_CODE  FROM PRODUCT_PLACE_ROWS AS PPR";x+=" LEFT JOIN PRODUCT_PLACE AS PP ON PP.PRODUCT_PLACE_ID=PPR.PRODUCT_PLACE_ID",x+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn+".DEPARTMENT AS D ON D.DEPARTMENT_ID=PP.STORE_ID",x+=" WHERE STOCK_ID="+e+" AND D.BRANCH_ID IN (SELECT D.BRANCH_ID FROM "+generalParamsSatis.dataSources.dsn+".EMPLOYEE_POSITIONS AS EP INNER JOIN "+generalParamsSatis.dataSources.dsn+".DEPARTMENT AS D ON D.DEPARTMENT_ID =EP.DEPARTMENT_ID WHERE EP.POSITION_CODE=EP.POSITION_CODE)";var k=wrk_query(x,"dsn3"),L="";if(0==s.length){if(k.recordcount>0){if(k.recordcount>1&&0==I){B="&pid_="+t+"&sid_="+e+"&tax="+u+"&cost="+E+"&manuel="+A+"&product_name="+d+"&stock_code="+r+"&brand="+a+"&indirim1="+l+"&amount="+i+"&unit="+v+"&price="+o+"&other_money="+_+"&price_other="+m;return B+="&is_virtual="+n,B+="&product_type="+c,B+="&shelf_code="+s,B+="&rowNum="+row_count,openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_select_raf_pbs"+B),!0}L=k.SHELF_CODE[0]}}else L=s;row_count++,rowCount=row_count;var U=moneyArr.find(t=>t.MONEY==_),M=m*U.RATE2;if(0==o){x="SELECT ISNULL("+generalParamsSatis.dataSources.dsn3+".GET_CURRENT_PRODUCT_PRICE("+CompanyData.COMPANY_ID+","+CompanyData.PRICE_CAT+","+e+"),0) AS FIYAT",k=wrk_query(x,"dsn3");M=k.FIYAT[0],o=k.FIYAT[0],m=k.FIYAT[0],_="TL"}var F=document.createElement("tr");1==A&&F.setAttribute("style","background-color:#86b5ff75 !important;"),F.setAttribute("id","row_"+row_count),F.setAttribute("data-selected","0"),F.setAttribute("data-rc",row_count),F.setAttribute("data-ProductType",c),F.setAttribute("class","sepetRow");var H=document.createElement("td"),Y=document.createElement("span");Y.innerText=row_count,Y.setAttribute("id","spn_"+row_count),H.appendChild(Y);var K=document.createElement("span");1!=row_count?(K.setAttribute("class","fa fa-arrow-up"),K.setAttribute("onclick","moveRow("+row_count+","+(row_count-1)+")")):K.setAttribute("class",""),H.appendChild(K),F.appendChild(H);H=document.createElement("td");var q=document.createElement("input");q.setAttribute("type","checkbox"),q.setAttribute("data-row",row_count),q.setAttribute("onclick","selectrw(this)"),H.appendChild(q),F.appendChild(H);H=document.createElement("td");var G=document.createElement("input");G.setAttribute("name","product_id_"+row_count),G.setAttribute("id","product_id_"+row_count),G.setAttribute("type","hidden"),G.setAttribute("value",t);var W=document.createElement("input");W.setAttribute("name","stock_id_"+row_count),W.setAttribute("id","stock_id_"+row_count),W.setAttribute("type","hidden"),W.setAttribute("value",e);var j=document.createElement("input");j.setAttribute("name","is_virtual_"+row_count),j.setAttribute("id","is_virtual_"+row_count),j.setAttribute("type","hidden"),j.setAttribute("value",n);var J=document.createElement("input");J.setAttribute("name","shelf_code_"+row_count),J.setAttribute("id","shelf_code_"+row_count),J.setAttribute("type","hidden"),J.setAttribute("value",L);var V=document.createElement("input");V.setAttribute("name","cost_"+row_count),V.setAttribute("id","cost_"+row_count),V.setAttribute("type","hidden"),V.setAttribute("value",E);var X=document.createElement("input");X.setAttribute("name","is_karma_"+row_count),X.setAttribute("id","is_karma_"+row_count),X.setAttribute("type","hidden"),X.setAttribute("value",S);var z=document.createElement("input");z.setAttribute("name","is_production_"+row_count),z.setAttribute("id","is_production_"+row_count),z.setAttribute("type","hidden"),z.setAttribute("value",T);var Q=document.createElement("input");if(Q.setAttribute("name","row_uniq_id_"+row_count),Q.setAttribute("id","row_uniq_id_"+row_count),Q.setAttribute("type","hidden"),P.length>0)Q.setAttribute("value",P);else{var Z=GenerateUniqueId();Q.setAttribute("value",Z)}var tt=document.createElement("input");tt.setAttribute("name","is_manuel_"+row_count),tt.setAttribute("id","is_manuel_"+row_count),tt.setAttribute("type","hidden"),tt.setAttribute("value",A),H.appendChild(G),H.appendChild(W),H.appendChild(j),H.appendChild(J),H.appendChild(V),H.appendChild(X),H.appendChild(z),H.appendChild(Q),H.appendChild(tt);J=document.createElement("input");J.setAttribute("name","stock_code_"+row_count),J.setAttribute("id","stock_code_"+row_count),J.setAttribute("type","text"),J.setAttribute("readonly",""),J.setAttribute("style","width:40px"),J.setAttribute("class","stockkodu"),J.setAttribute("value",r);var et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:15%");J=document.createElement("input");J.setAttribute("name","product_name_"+row_count),J.setAttribute("id","product_name_"+row_count),J.setAttribute("class","urunadi"),J.setAttribute("type","text"),J.setAttribute("style","width:40px"),J.setAttribute("value",d);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:5%");J=document.createElement("input");J.setAttribute("name","brand_name_"+row_count),J.setAttribute("id","brand_name_"+row_count),J.setAttribute("type","text"),J.setAttribute("disabled",""),J.setAttribute("value",a);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);var rt=getRafSml(e,L);H=document.createElement("td");H.setAttribute("style","width:5%");J=document.createElement("input");J.setAttribute("name","department_name"+row_count),J.setAttribute("id","department_name"+row_count),J.setAttribute("type","text"),J.setAttribute("disabled",""),J.setAttribute("value",rt);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","display:flex;align-items: baseline;");et=document.createElement("div");et.setAttribute("class","form-group");var at=AsamaYapici(row_count,p),nt=document.createElement("span");nt.setAttribute("class","icon-detail"),nt.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.popup_detail_product&pid="+t+"&sid="+e+"')"),et.appendChild(at),H.appendChild(et),1!=n&&H.appendChild(nt),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:3%");V=document.createElement("input");V.setAttribute("name","amount_"+row_count),V.setAttribute("id","amount_"+row_count),V.setAttribute("type","text"),V.setAttribute("class","prtMoneyBox"),V.setAttribute("value",commaSplit(i,2)),V.setAttribute("onchange","hesapla('price',"+row_count+")"),V.setAttribute("onClick","sellinputAllVal(this)");et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(V),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:3%");V=document.createElement("input");V.setAttribute("name","main_unit_"+row_count),V.setAttribute("id","main_unit_"+row_count),V.setAttribute("type","text"),V.setAttribute("style","width:20px"),V.setAttribute("readonly",""),V.setAttribute("value",v);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(V),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:3%");var it=document.createElement("select");it.setAttribute("name","other_money_"+row_count),it.setAttribute("id","other_money_"+row_count),it.setAttribute("onchange","hesapla('other_money',"+row_count+")");for(let t=0;t<moneyArr.length;t++){const e=moneyArr[t];var ot=document.createElement("option");ot.setAttribute("value",e.MONEY),ot.innerText=e.MONEY,it.appendChild(ot)}it.value=_;et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(it),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:5%");var dt=document.createElement("input");dt.setAttribute("name","price_other_"+row_count),dt.setAttribute("id","price_other_"+row_count),dt.setAttribute("type","text"),dt.setAttribute("onchange","hesapla('price_other',"+row_count+")"),dt.setAttribute("class","prtMoneyBox"),dt.setAttribute("style","width:30px"),dt.setAttribute("value",commaSplit(m));et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(dt),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:5%");z=document.createElement("input");z.setAttribute("name","price_"+row_count),z.setAttribute("id","price_"+row_count),z.setAttribute("type","text"),z.setAttribute("onchange","hesapla('price',"+row_count+")"),z.setAttribute("onClick","sellinputAllVal(this)"),z.setAttribute("class","prtMoneyBox"),z.setAttribute("style","width:30px"),z.setAttribute("value",commaSplit(M,2));et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(z),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:5%");var ut=document.createElement("input");ut.setAttribute("name","indirim1_"+row_count),ut.setAttribute("id","indirim1_"+row_count),ut.setAttribute("value",commaSplit(l)),ut.setAttribute("type","text"),ut.setAttribute("onchange","getSetNum(this)&hesapla('price',"+row_count+")"),ut.setAttribute("class","prtMoneyBox");et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(ut),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:10%");var lt=document.createElement("input");lt.setAttribute("name","row_nettotal_"+row_count),lt.setAttribute("id","row_nettotal_"+row_count),lt.setAttribute("type","text"),lt.setAttribute("class","prtMoneyBox"),lt.setAttribute("value",commaSplit(0,2));et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(lt),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:15%");J=document.createElement("input");J.setAttribute("name","product_name_other_"+row_count),J.setAttribute("id","product_name_other_"+row_count),J.setAttribute("type","text"),J.setAttribute("style","width:40px"),J.setAttribute("value",b);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","width:8%");J=document.createElement("input");J.setAttribute("name","detail_info_extra_"+row_count),J.setAttribute("id","detail_info_extra_"+row_count),J.setAttribute("type","text"),J.setAttribute("style","width:40px"),J.setAttribute("value",C);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);var ct=new Date;H=document.createElement("td");H.setAttribute("style","width:10%");J=document.createElement("input");J.setAttribute("name","deliver_date_"+row_count),J.setAttribute("id","deliver_date_"+row_count),J.setAttribute("type","date"),h.length>0?J.setAttribute("value",h):J.setAttribute("value",ct.toISOString().split("T")[0]);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(J),H.appendChild(et),F.appendChild(H);H=document.createElement("td");H.setAttribute("style","display:none"),H.setAttribute("class","hiddenR");var st=document.createElement("input");st.setAttribute("name","Tax_"+row_count),st.setAttribute("id","Tax_"+row_count),st.setAttribute("value",commaSplit(u));var _t=document.createElement("input");_t.setAttribute("name","converted_sid_"+row_count),_t.setAttribute("id","converted_sid_"+row_count),_t.setAttribute("value",D);et=document.createElement("div");et.setAttribute("class","form-group"),et.appendChild(st),et.appendChild(_t),H.appendChild(et),F.appendChild(H);H=document.createElement("td"),et=document.createElement("div");et.setAttribute("class","form-group");var mt=document.createElement("input");mt.setAttribute("name","description_"+row_count),mt.setAttribute("id","description_"+row_count),mt.setAttribute("value",w),et.appendChild(mt),H.appendChild(et),F.appendChild(H),rowaListener(F);var pt=document.getElementById("tbl_basket");pt.appendChild(F),hesapla("other_money",rowCount),manuelControl(),RowControlForVirtual()}function AddRow_pbso(t,e,r,a,n,i,o,d,u,l,c=0,s="",_="TL",m,p="-6",A=0,E=0,v="Adet",b="",C="",I=0,y="",h="",T=0,P="",w="",g="",D=0,S=0,O=0){console.log(arguments);var f=$(document),R=f.find("input[name=_rd_money]:checked").val();document.getElementById("_hidden_rd_money_"+R).value;if("M"==v&&0==I){var N="&pid_="+t+"&sid_="+e+"&tax="+u+"&cost="+E+"&manuel="+A+"&product_name="+d+"&stock_code="+r+"&brand="+a+"&indirim1="+l+"&amount="+i+"&unit="+v+"&price="+o+"&other_money="+_+"&price_other="+m;return N+="&is_virtual="+n,N+="&product_type="+c,N+="&shelf_code="+s,N+="&rowNum="+row_count,openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_extra_calculate_pbs"+N),!0}var B="SELECT PP.SHELF_CODE  FROM PRODUCT_PLACE_ROWS AS PPR";B+=" LEFT JOIN PRODUCT_PLACE AS PP ON PP.PRODUCT_PLACE_ID=PPR.PRODUCT_PLACE_ID",B+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn+".DEPARTMENT AS D ON D.DEPARTMENT_ID=PP.STORE_ID",B+=" WHERE STOCK_ID="+e+" AND D.BRANCH_ID IN (SELECT D.BRANCH_ID FROM "+generalParamsSatis.dataSources.dsn+".EMPLOYEE_POSITIONS AS EP INNER JOIN "+generalParamsSatis.dataSources.dsn+".DEPARTMENT AS D ON D.DEPARTMENT_ID =EP.DEPARTMENT_ID WHERE EP.POSITION_CODE=EP.POSITION_CODE)";var x="";if(0==s.length&&0!=e){var k=wrk_query(B,"dsn3");if(k.recordcount>0){if(k.recordcount>1&&0==I){N="&pid_="+t+"&sid_="+e+"&tax="+u+"&cost="+E+"&manuel="+A+"&product_name="+d+"&stock_code="+r+"&brand="+a+"&indirim1="+l+"&amount="+i+"&unit="+v+"&price="+o+"&other_money="+_+"&price_other="+m;return N+="&is_virtual="+n,N+="&product_type="+c,N+="&shelf_code="+s,N+="&rowNum="+row_count,openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_select_raf_pbs"+N),!0}x=k.SHELF_CODE[0]}}else x=s;row_count++,rowCount=row_count;var L=moneyArr.find(t=>t.MONEY==_),U=m*L.RATE2;if(0==o){B="SELECT ISNULL("+generalParamsSatis.dataSources.dsn3+".GET_CURRENT_PRODUCT_PRICE("+CompanyData.COMPANY_ID+","+CompanyData.PRICE_CAT+","+e+"),0) AS FIYAT",k=wrk_query(B,"dsn3");U=k.FIYAT[0],o=k.FIYAT[0],m=k.FIYAT[0],_="TL"}var M=document.createElement("tr");1==A&&M.setAttribute("style","background-color:#86b5ff75 !important;"),M.setAttribute("id","row_"+row_count),M.setAttribute("data-selected","0"),M.setAttribute("data-rc",row_count),M.setAttribute("data-ProductType",c),M.setAttribute("class","sepetRow");var F=document.createElement("td"),H=document.createElement("span");H.innerText=row_count,H.setAttribute("id","spn_"+row_count),F.appendChild(H);var Y=document.createElement("span");1!=row_count?(Y.setAttribute("class","fa fa-arrow-up"),Y.setAttribute("onclick","moveRow("+row_count+","+(row_count-1)+")")):Y.setAttribute("class",""),F.appendChild(Y),M.appendChild(F);F=document.createElement("td");var K=document.createElement("input");K.setAttribute("type","checkbox"),K.setAttribute("data-row",row_count),K.setAttribute("onclick","selectrw(this)"),F.appendChild(K),M.appendChild(F);F=document.createElement("td");var q=document.createElement("input");q.setAttribute("name","product_id_"+row_count),q.setAttribute("id","product_id_"+row_count),q.setAttribute("type","hidden"),q.setAttribute("value",t);var G=document.createElement("input");G.setAttribute("name","stock_id_"+row_count),G.setAttribute("id","stock_id_"+row_count),G.setAttribute("type","hidden"),G.setAttribute("value",e);var W=document.createElement("input");W.setAttribute("name","is_virtual_"+row_count),W.setAttribute("id","is_virtual_"+row_count),W.setAttribute("type","hidden"),W.setAttribute("value",n);var j=document.createElement("input");j.setAttribute("name","shelf_code_"+row_count),j.setAttribute("id","shelf_code_"+row_count),j.setAttribute("type","hidden"),j.setAttribute("value",x);var J=document.createElement("input");J.setAttribute("name","cost_"+row_count),J.setAttribute("id","cost_"+row_count),J.setAttribute("type","hidden"),J.setAttribute("value",E);var V=document.createElement("input");V.setAttribute("name","is_karma_"+row_count),V.setAttribute("id","is_karma_"+row_count),V.setAttribute("type","hidden"),V.setAttribute("value",S);var X=document.createElement("input");X.setAttribute("name","is_production_"+row_count),X.setAttribute("id","is_production_"+row_count),X.setAttribute("type","hidden"),X.setAttribute("value",T);var z=document.createElement("input");if(z.setAttribute("name","row_uniq_id_"+row_count),z.setAttribute("id","row_uniq_id_"+row_count),z.setAttribute("type","hidden"),P.length>0)z.setAttribute("value",P);else{var Q=GenerateUniqueId();z.setAttribute("value",Q)}var Z=document.createElement("input");Z.setAttribute("name","is_manuel_"+row_count),Z.setAttribute("id","is_manuel_"+row_count),Z.setAttribute("type","hidden"),Z.setAttribute("value",A),F.appendChild(q),F.appendChild(G),F.appendChild(W),F.appendChild(j),F.appendChild(J),F.appendChild(V),F.appendChild(X),F.appendChild(z),F.appendChild(Z);j=document.createElement("input");j.setAttribute("name","stock_code_"+row_count),j.setAttribute("id","stock_code_"+row_count),j.setAttribute("type","text"),j.setAttribute("readonly",""),j.setAttribute("style","width:40px"),j.setAttribute("class","stockkodu"),j.setAttribute("value",r);var tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:15%");j=document.createElement("input");j.setAttribute("name","product_name_"+row_count),j.setAttribute("id","product_name_"+row_count),j.setAttribute("class","urunadi"),j.setAttribute("type","text"),j.setAttribute("style","width:40px"),j.setAttribute("value",d);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:5%");j=document.createElement("input");j.setAttribute("name","brand_name_"+row_count),j.setAttribute("id","brand_name_"+row_count),j.setAttribute("type","text"),j.setAttribute("disabled",""),j.setAttribute("value",a);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);var et=g;F=document.createElement("td");F.setAttribute("style","width:5%");j=document.createElement("input");j.setAttribute("name","department_name"+row_count),j.setAttribute("id","department_name"+row_count),j.setAttribute("type","text"),j.setAttribute("disabled",""),j.setAttribute("value",et);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","display:flex;align-items: baseline;");tt=document.createElement("div");tt.setAttribute("class","form-group");var rt=AsamaYapici(row_count,p),at=document.createElement("span");at.setAttribute("class","icon-detail"),at.setAttribute("onclick","openBoxDraggable('index.cfm?fuseaction=objects.popup_detail_product&pid="+t+"&sid="+e+"')"),tt.appendChild(rt),F.appendChild(tt),1!=n&&F.appendChild(at),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:3%");J=document.createElement("input");J.setAttribute("name","amount_"+row_count),J.setAttribute("id","amount_"+row_count),J.setAttribute("type","text"),J.setAttribute("class","prtMoneyBox"),J.setAttribute("value",commaSplit(i,2)),J.setAttribute("onchange","hesapla('price',"+row_count+")"),J.setAttribute("onClick","sellinputAllVal(this)");tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(J),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:3%");J=document.createElement("input");J.setAttribute("name","main_unit_"+row_count),J.setAttribute("id","main_unit_"+row_count),J.setAttribute("type","text"),J.setAttribute("style","width:20px"),J.setAttribute("readonly",""),J.setAttribute("value",v);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(J),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:3%");var nt=document.createElement("select");nt.setAttribute("name","other_money_"+row_count),nt.setAttribute("id","other_money_"+row_count),nt.setAttribute("onchange","hesapla('other_money',"+row_count+")");for(let t=0;t<moneyArr.length;t++){const e=moneyArr[t];var it=document.createElement("option");it.setAttribute("value",e.MONEY),it.innerText=e.MONEY,nt.appendChild(it)}nt.value=_;tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(nt),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:5%");var ot=document.createElement("input");ot.setAttribute("name","price_other_"+row_count),ot.setAttribute("id","price_other_"+row_count),ot.setAttribute("type","text"),ot.setAttribute("onchange","hesapla('price_other',"+row_count+")"),ot.setAttribute("class","prtMoneyBox"),ot.setAttribute("style","width:30px"),ot.setAttribute("value",commaSplit(m));tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(ot),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:5%");X=document.createElement("input");X.setAttribute("name","price_"+row_count),X.setAttribute("id","price_"+row_count),X.setAttribute("type","text"),X.setAttribute("onchange","hesapla('price',"+row_count+")"),X.setAttribute("onClick","sellinputAllVal(this)"),X.setAttribute("class","prtMoneyBox"),X.setAttribute("style","width:30px"),X.setAttribute("value",commaSplit(U,2));tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(X),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:5%");var dt=document.createElement("input");dt.setAttribute("name","indirim1_"+row_count),dt.setAttribute("id","indirim1_"+row_count),dt.setAttribute("value",commaSplit(l)),dt.setAttribute("type","text"),dt.setAttribute("onchange","getSetNum(this)&hesapla('price',"+row_count+")"),dt.setAttribute("class","prtMoneyBox");tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(dt),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:10%");var ut=document.createElement("input");ut.setAttribute("name","row_nettotal_"+row_count),ut.setAttribute("id","row_nettotal_"+row_count),ut.setAttribute("type","text"),ut.setAttribute("class","prtMoneyBox"),ut.setAttribute("value",commaSplit(0,2));tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(ut),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:15%");j=document.createElement("input");j.setAttribute("name","product_name_other_"+row_count),j.setAttribute("id","product_name_other_"+row_count),j.setAttribute("type","text"),j.setAttribute("style","width:40px"),j.setAttribute("value",b);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","width:8%");j=document.createElement("input");j.setAttribute("name","detail_info_extra_"+row_count),j.setAttribute("id","detail_info_extra_"+row_count),j.setAttribute("type","text"),j.setAttribute("style","width:40px"),j.setAttribute("value",C);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);var lt=new Date;F=document.createElement("td");F.setAttribute("style","width:10%");j=document.createElement("input");j.setAttribute("name","deliver_date_"+row_count),j.setAttribute("id","deliver_date_"+row_count),j.setAttribute("type","date"),h.length>0?j.setAttribute("value",h):j.setAttribute("value",lt.toISOString().split("T")[0]);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(j),F.appendChild(tt),M.appendChild(F);F=document.createElement("td");F.setAttribute("style","display:none"),F.setAttribute("class","hiddenR");var ct=document.createElement("input");ct.setAttribute("name","Tax_"+row_count),ct.setAttribute("id","Tax_"+row_count),ct.setAttribute("value",commaSplit(u));var st=document.createElement("input");st.setAttribute("name","converted_sid_"+row_count),st.setAttribute("id","converted_sid_"+row_count),st.setAttribute("value",D);tt=document.createElement("div");tt.setAttribute("class","form-group"),tt.appendChild(st),tt.appendChild(ct),F.appendChild(tt),M.appendChild(F);F=document.createElement("td"),tt=document.createElement("div");tt.setAttribute("class","form-group");var _t=document.createElement("input");_t.setAttribute("name","description_"+row_count),_t.setAttribute("id","description_"+row_count),_t.setAttribute("value",w),tt.appendChild(_t),F.appendChild(tt),M.appendChild(F),rowaListener(M);var mt=document.getElementById("tbl_basket");mt.appendChild(M),hesapla("other_money",rowCount),manuelControl(),RowControlForVirtual(),FiyatTalepKontrol(rowCount)}function AsamaYapici(t,e){var r=document.createElement("select");r.setAttribute("name","orderrow_currency_"+t),r.setAttribute("id","orderrow_currency_"+t);var a=document.createElement("option");a.setAttribute("value",-5),a.innerText="Üretim",r.appendChild(a);a=document.createElement("option");a.setAttribute("value",-6),a.innerText="Sevk",r.appendChild(a);a=document.createElement("option");a.setAttribute("value",-2),a.innerText="Tedarik",r.appendChild(a);a=document.createElement("option");a.setAttribute("value",-1),a.innerText="Açık",r.appendChild(a);a=document.createElement("option");a.setAttribute("value",-10),a.innerText="Kapatıldı",r.appendChild(a);a=document.createElement("option");return a.setAttribute("value",1),a.innerText="Fiyat Talep",r.appendChild(a),r.value=e,r}function manuelControl(){var t=document.getElementsByClassName("sepetRow");for(let r=1;r<=t.length;r++){var e=document.getElementById("is_manuel_"+r).value;1==parseInt(e)&&$("#row_"+r).css("background","#86b5ff75"),hesapla("other_money",r)}}function UpdRow(t,e,r,a,n,i,o,d,u,l=-1,c="",s="Adet"){console.log("Basket PC Upd Row"),console.log(arguments),$("#product_id_"+u).val(t),$("#stock_id_"+u).val(e),$("#is_virtual_"+u).val(r),a>0&&$("#amount_"+u).val(a),n>0&&$("#price_"+u).val(n),$("#product_name_"+u).val(i),$("#Tax_"+u).val(o),d>0&&$("#indirim1_"+u).val(d),$("#orderrow_currency_"+u).val(l),$("#stock_code_"+u).val(c),$("#main_unit_"+u).val(s),hesapla("price",u),RowControlForVirtual()}function ShelfControl(t,e){var r="select DISTINCT SHELF_CODE,PPR.PRODUCT_PLACE_ID,PPR.PRODUCT_ID,PP.STORE_ID,PP.LOCATION_ID,PPR.PRODUCT_ID,SL.DEPARTMENT_LOCATION from "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE_ROWS AS PPR";r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE AS PP ON PP.PRODUCT_PLACE_ID=PPR.PRODUCT_PLACE_ID ",r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn+".STOCKS_LOCATION AS SL ON  SL.LOCATION_ID=PP.LOCATION_ID AND SL.DEPARTMENT_ID=PP.STORE_ID ",r+="WHERE PPR.PRODUCT_ID="+t+" AND SHELF_CODE='"+e+"'";var a=wrk_query(r,"dsn3");return 0!=a.recordcount||(0==generalParamsSatis.workingParams.IS_RAFSIZ?(alert("Ürün Bu Rafta Tanımlı Değildir Veya Raf Kodu Bulunamamıştır"),!1):(alert("Ürün Bu Rafta Tanımlı Değildir Veya Raf Kodu Bulunamamıştır Rafsız Kayıt Yapılacaktır"),!0))}function getRafSml(t,e){var r="SELECT PP.SHELF_CODE,SL.COMMENT,D.DEPARTMENT_HEAD,PP.LOCATION_ID,PP.STORE_ID FROM "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE_ROWS AS PPR ";r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".PRODUCT_PLACE AS PP ON PPR.PRODUCT_PLACE_ID=PP.PRODUCT_PLACE_ID",r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn+".STOCKS_LOCATION AS SL ON SL.LOCATION_ID=PP.LOCATION_ID AND SL.DEPARTMENT_ID=PP.STORE_ID",r+=" LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID",r+=" WHERE PPR.STOCK_ID="+t+" AND PP.SHELF_CODE='"+e+"'";var a=wrk_query(r);return a.recordcount>0?a.DEPARTMENT_HEAD[0]+" "+a.COMMENT[0]:""}function hesapla(t,e){var r=$("#price_"+e).val(),a=$("#price_other_"+e).val();r=-1!=r.indexOf(",")?filterNum(r,8):filterNum(commaSplit(r),8),a=-1!=a.indexOf(",")?filterNum(a,8):filterNum(commaSplit(a),8);var n=filterNum($("#amount_"+e).val(),8),i=$("#cost_"+e).val(),o=filterNum($("#indirim1_"+e).val(),8),d=$("#other_money_"+e).val(),u=filterNum($("#_txt_rate1_"+$("input[id^='_hidden_rd_money_'][value='"+d+"']").prop("id").split("_")[4]).val(),8),l=filterNum($("#_txt_rate2_"+$("input[id^='_hidden_rd_money_'][value='"+d+"']").prop("id").split("_")[4]).val(),8);$("#qs_basket tbody tr[data-rc='"+e+"']").css("background-color","white"),list_find("price,other_money",t)?a=r*u/l:"price_other"==t&&(r=a*l/u);var c=r*(100-o)/100*n;if(generalParamsSatis.workingParams.MALIYET_CONTROL)if(parseFloat(r*(100-o)/100)<parseFloat(i))document.getElementById("row_"+e).setAttribute("style","background-color:#ff06005c");else{var s=parseInt(document.getElementById("is_manuel_"+e).value);0==s&&document.getElementById("row_"+e).removeAttribute("style")}$("#price_other_"+e).val(commaSplit(a,2)),$("#price_"+e).val(commaSplit(r,2)),$("#row_nettotal_"+e).val(commaSplit(c,2)),$("#amount_"+e).val(commaSplit(n,2)),toplamHesapla(),toplamHesapla_2()}function toplamHesapla(){var t=0,e=0,r=0;for(let a=1;a<=rowCount;a++)if($("#price_"+a).val()){let n=filterNum($("#price_"+a).val(),8),i=(filterNum($("#price_other_"+a).val(),8),filterNum($("#amount_"+a).val(),8),filterNum($("#indirim1_"+a).val(),8),$("#Tax_"+a).val()),o=$("#other_money_"+a).val(),d=filterNum($("#row_nettotal_"+a).val(),8);filterNum($("#_txt_rate1_"+$("input[id^='_hidden_rd_money_'][value='"+o+"']").prop("id").split("_")[4]).val(),8),filterNum($("#_txt_rate2_"+$("input[id^='_hidden_rd_money_'][value='"+o+"']").prop("id").split("_")[4]).val(),8);parseFloat(n),t+=parseFloat(d),e+=parseFloat(d)*(parseInt(i)/100),r+=parseFloat(d)*(1+parseInt(i)/100)}$("#subTotal").val(commaSplit(t,2)),$("#subTaxTotal").val(commaSplit(e,2)),$("#subWTax").val(commaSplit(r,2))}function toplamHesapla_2(){var t=document.getElementsByClassName("sepetRow"),e=0,r=0,a=0,n=0;for(let m=1;m<=t.length;m++){var i=filterNum(document.getElementById("price_"+m).value),o=filterNum(document.getElementById("amount_"+m).value),d=filterNum(document.getElementById("indirim1_"+m).value),u=filterNum(document.getElementById("Tax_"+m).value),l=i*o,c=l*d/100,s=l-c,_=s*u/100;e+=s,r+=_,a+=c,n+=l}var m=parseFloat(filterNum($("#txt_disc").val()));$("#txt_disc").val(commaSplit(m,3))
;var p=e*generalParamsSatis.workingParams.MAX_DISCOINT/100;m>p&&(alert("Genel İndirim İşlem Tutarının %"+generalParamsSatis.workingParams.MAX_DISCOINT+"'ndan büyük Olmaz İndirim 0'lanacaktır"),$("#txt_disc").val(commaSplit(0,3)),m=0),$("#txt_total").val(commaSplit(n,3)),a+=m,$("#txt_disc_total").val(commaSplit(a,3)),e=n-a,$("#txt_nokdv_total").val(commaSplit(e,3)),$("#txt_kdv_total").val(commaSplit(r,3)),$("#txt_withkdv_total").val(commaSplit(e+r,3)),$("#basket_bottom_total").val(commaSplit(e+r,3))}function sellinputAllVal(t){t.select()}function GetBasketData(){var t=document.getElementsByClassName("sepetRow"),e=new Array,r=0;for(let g=1;g<=t.length;g++){var a=document.getElementById("product_name_"+g).value,n=document.getElementById("product_id_"+g).value,i=document.getElementById("stock_id_"+g).value,o=document.getElementById("is_virtual_"+g).value,d=document.getElementById("amount_"+g).value,u=document.getElementById("price_"+g).value,l=document.getElementById("other_money_"+g).value,c=document.getElementById("is_karma_"+g).value,s=document.getElementById("row_nettotal_"+g).value,_=document.getElementById("converted_sid_"+g).value,m=document.getElementById("shelf_code_"+g).value,p=document.getElementById("Tax_"+g).value,A=document.getElementById("indirim1_"+g).value,E=document.getElementById("price_other_"+g).value,v=document.getElementById("orderrow_currency_"+g).value,b=document.getElementById("product_name_other_"+g).value,C=document.getElementById("detail_info_extra_"+g).value,I=document.getElementById("deliver_date_"+g).value,y=document.getElementById("is_production_"+g).value,h=document.getElementById("description_"+g).value,T=document.getElementById("row_uniq_id_"+g).value;if(!generalParamsSatis.workingParams.IS_ZERO_QUANTITY){var P=filterNum(u);P<=0&&r++,r>0&&alert("0 Fiyatlı Kayıt Yapamazsıznız")}var w={product_name:a,product_id:n,stock_id:i,is_virtual:o,amount:d,price:u,other_money:l,row_nettotal:s,shelf_code:m,Tax:p,indirim1:A,price_other:E,orderrow_currency:v,product_name_other:b,detail_info_extra:C,deliver_date_bask:I,is_production:y,row_uniq_id:T,description:h,converted_sid:_,is_karma:c};e.push(w)}var g=document.getElementById("company_id").value,D=document.getElementById("is_from_project").value,S=document.getElementById("company_name").value,O=document.getElementById("PAYMETHOD").value,f=document.getElementById("PAYMETHOD_ID").value,R=document.getElementById("VADE").value,N=document.getElementById("company_partner_name").value,B=document.getElementById("company_partner_id").value,x=document.getElementById("process_stage").value,k=document.getElementById("SHIP_METHOD").value,L=document.getElementById("SHIP_METHOD_ID").value,U=document.getElementById("order_id").value,M=document.getElementById("subTotal").value,F=document.getElementById("subTaxTotal").value,H=document.getElementById("subWTax").value,Y=document.getElementById("txt_total").value,K=document.getElementById("txt_disc").value,q=document.getElementById("txt_disc_total").value,G=document.getElementById("txt_nokdv_total").value,W=document.getElementById("txt_kdv_total").value,j=document.getElementById("txt_withkdv_total").value,J=document.getElementById("offer_date").value,V=document.getElementById("offer_head").value,X=document.getElementById("ship_address").value,z=document.getElementById("ship_address_id").value,Q=document.getElementById("city_id").value,Z=document.getElementById("county_id").value,tt=document.getElementById("offer_desc").value,et=document.getElementById("PRICE_CATID").value,rt=document.getElementById("project_name").value,at=document.getElementById("project_id").value;M=filterNum(M,4),F=filterNum(F,4),H=filterNum(H,4),Y=filterNum(Y,4),K=filterNum(K,4),q=filterNum(q,4),G=filterNum(G,4),W=filterNum(W,4),j=filterNum(j,4);var nt=$(document),it=nt.find("input[name=_rd_money]:checked").val(),ot="";$("#snl_teklif").is(":checked")&&(ot+="1,"),$("#siparis").is(":checked")&&(ot+="2,"),$("#sevkiyat").is(":checked")&&(ot+="3,"),$("#sales_type_1").is(":checked")&&(ot+="4,");var dt=document.getElementById("_hidden_rd_money_"+it).value,ut=document.getElementById("_txt_rate1_"+it).value,lt=document.getElementById("_txt_rate2_"+it).value,ct=document.getElementById("plasiyer").value,st=document.getElementById("plasiyer_id").value,_t=filterNum(ut,4),mt=filterNum(lt,4),pt=getParameterByName("fuseaction"),At={COMPANY_ID:g,PAYMETHOD:O,PAYMETHOD_ID:f,VADE:R,COMPANY_PARTNER_NAME:N,COMPANY_PARTNER_ID:B,MEMBER_NAME:S,PROCESS_STAGE:x,SHIP_METHOD:k,SHIP_METHOD_ID:L,ORDER_ID:U,OFFER_DATE:J,OFFER_HEAD:V,SHIP_ADDRESS:X,SHIP_ADDRESS_ID:z,CITY_ID:Q,COUNTY_ID:Z,ISLEM_TIPI_PBS:ot,PRICE_CATID:et,PLASIYER:ct,PLASIYER_ID:st,FACT:pt,OFFER_DESCRIPTION:tt,PROJECT_NAME:rt,PROJECT_ID:at,IS_FROM_PROJECT:D,IS_FROM_PROJECT:D},Et={SUBTOTAL:M,SUBTAXTOTAL:F,SUBNETTOTAL:H,BASKET_MONEY:dt,BASKET_RATE_1:_t,BASKET_RATE_2:mt,GROSS_TOTAL:Y,AFTER_DISCOUNT:K,DISCOUNT_TOTAL:q,TOTAL_WITHOUT_KDV:G,TAX_TOTAL:W,TOTAL_WITH_KDV:j},vt={OrderHeader:At,OrderRows:e,OrderMoney:moneyArr,OrderFooter:Et,WORKING_PARAMS:generalParamsSatis.workingParams};return vt}function KntO(){var t=0,e=document.getElementsByClassName("sepetRow"),r=document.getElementById("siparis"),a=$(r).is(":checked");for(let r=1;r<=e.length;r++){var n=$("#orderrow_currency_"+r).val();-5!=parseInt(n)&&-2!=parseInt(n)||a||(alert("Sipariş Seçili Olması Gerekmektedir"),t=!0),-1==parseInt(n)&&a&&(alert("Sipariş Yapmak İçin Açıkta Aşama Kalmış Olmaması Gerekmektedir "),t=!0),1==parseInt(n)&&a&&(alert("Fiyat Talep Aşamasında  Kalmış Olmaması Gerekmektedir "),t=!0)}return!t}function SaveOrder(t){t.setAttribute("disabled","true");var e=GetBasketData();KntO()?e&&SendFormData("/index.cfm?fuseaction=sales.emptypopup_query_save_order",e):t.removeAttribute("disabled")}function GruplaCanimBenim(){var t=!1,e=prompt("Hortum Takımı Adı ?"),r=document.getElementById("PRICE_CATID").value,a=document.getElementById("company_id").value,n=new Array,i=0;for(let t=0;t<selectedArr.length;t++){var o=selectedArr[t].getAttribute("data-producttype"),d=selectedArr[t].getAttribute("data-rc"),u=document.getElementById("product_id_"+d).value,l=document.getElementById("stock_id_"+d).value,c=document.getElementById("amount_"+d).value;c=parseFloat(filterNum(c));document.getElementById("main_unit_"+d).value;var s=document.getElementById("price_other_"+d).value;s=parseFloat(filterNum(s));var _=document.getElementById("other_money_"+d).value,m=document.getElementById("price_"+d).value;m=parseFloat(filterNum(m));var p=document.getElementById("Tax_"+d).value;p=filterNum(p);var A=parseFloat(m)*parseFloat(c);i+=A,console.log(u);var E={PRODUCT_ID:u,STOCK_ID:l,AMOUNT:c,PRICE:s,OTHER_MONEY:_,ROW_NET_TOTAL:A,TAX:p};n.push(E),parseInt(o)}var v={PRODUCT_NAME_MAIN:e,PRODUCT_LIST:n,PRICE_CATID:r,COMPANY_ID:a,PRICE_TOTAL:i};if(1==t)return!1;SendFormData("/index.cfm?fuseaction=product.emptypopup_makeTubeGroup",v)}function SendFormData(t,e){var r=document.createElement("form");r.target="Map",r.method="POST",r.action=t;var a=document.createElement("input");a.type="hidden",a.name="data",a.value=JSON.stringify(e),r.appendChild(a),document.body.appendChild(r),map=window.open(t,"Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?r.submit():alert("You must allow popups for this map to work.")}function selectrw(t){if(rwwwx=t,$(rwwwx).is(":checked")){var e=rwwwx.getAttribute("data-row"),r=document.getElementById("row_"+e);r.setAttribute("style","background-color:#aaefff80"),r.setAttribute("data-selected",1)}else{e=rwwwx.getAttribute("data-row"),r=document.getElementById("row_"+e);r.setAttribute("style","background-color:#fff"),r.setAttribute("data-selected",0)}BasketSelControl()}function groupControl(){GruplaCanimBenim()}function BasketSelControl(){selectedArr.splice(0,selectedArr.length);var t={icon:"icn-md fa fa-cubes",txt:"Grupla",evntType:"onclick",evnt:"groupControl()",att:"disabled"},e={icon:"icn-md icon-remove",txt:"Seçili Olanları Sil",evntType:"onclick",evnt:"removeSelected(this)",att:""},r={icon:"icn-md fa fa-history",txt:"Güncelle",evntType:"onclick",evnt:"return true",att:"disabled"},a={icon:"icn-md fa fa-tree",txt:"Ağaç Görüntüle",evntType:"onclick",evnt:"showTree(this)",att:"disabled"},n={icon:"icn-md fa fa-recycle",txt:"Fiyat Detay",evntType:"onclick",evnt:"TurnOut(this)",att:"disabled"},i={icon:"icn-md icon-check",txt:"Gerçek Ürüne Dönüştür",evntType:"onclick",evnt:"ConvertRealProduct(this)",att:"disabled"},o=[],d=document.getElementsByClassName("sepetRow");for(let t=0;t<d.length;t++){var u=d[t],l=u.getAttribute("data-selected");1==parseInt(l)&&selectedArr.push(u)}if(1==selectedArr.length){var c=selectedArr[0],s=c.getAttribute("data-rc"),_=c.getAttribute("data-producttype"),m=c.getAttribute("data-priceOffer"),p=$(c).find("#is_virtual_"+s).val(),A=$(c).find("#product_id_"+s).val();if(1==parseInt(p)){if(1==parseInt(_))r={icon:"icn-md fa fa-history",txt:"Güncelle",evntType:"onclick",evnt:"openHose("+A+","+s+")",att:""};else if(2==parseInt(_))r={icon:"icn-md fa fa-history",txt:"Güncelle",evntType:"onclick",evnt:"openHydrolic("+A+","+s+",1)",att:""};else if(4==parseInt(_))r={icon:"icn-md fa fa-history",txt:"Güncelle",evntType:"onclick",evnt:"openVirtualProduct("+A+","+s+")",att:""};else if(0==parseInt(_)||99==parseInt(_))i={icon:"icn-md icon-check",txt:"Gerçek Ürüne Dönüştür",evntType:"onclick",evnt:"ConvertRealProduct("+A+","+s+")",att:""}}else a={icon:"icn-md fa fa-tree",txt:"Ağaç Görüntüle",evntType:"onclick",evnt:"showTree("+s+")",att:""};if(1==parseInt(m))n={icon:"icn-md fa fa-recycle",txt:"Fiyat Talep Sonuçları",evntType:"onclick",evnt:"TurnOut(this,"+s+")",att:""}}return o.push(e,r,t,a,n,i),o}function showTree(t){elks=t,console.log(t);var e=document.getElementById("stock_id_"+t).value;openBoxDraggable("index.cfm?fuseaction=objects.emptypopup_show_tree_prt&stock_id="+e)}function TurnOut(t,e){var r=document.getElementById("row_uniq_id_"+e).value;openBoxDraggable("index.cfm?fuseaction=sales.emptypopup_add_pbs_offer_price_offerings&OfferrowUniqId="+r+"&row_id="+e)}function rowaListener(t){$(t).on("contextmenu",function(t){$(".pbsContex").remove(),t.preventDefault();var e=document.createElement("div");e.setAttribute("class","pbsContex"),$(e).attr("style","display:none;top:"+t.clientY+"px;left:"+t.clientX+"px");var r=document.createElement("div");r.setAttribute("style","border-top: solid 5px black;border-left: solid 5px black;width: 10px;height: 10px;");var a=document.createElement("div");a.setAttribute("class","list-group");var n=BasketSelControl();for(let t=0;t<n.length;t++){var i=n[t],o=document.createElement("a"),d=document.createElement("span");d.setAttribute("class",i.icon),d.setAttribute("style","margin-right:10px");var u=document.createElement("span");u.innerText=i.txt,o.appendChild(d),o.appendChild(u),"disabled"==i.att&&o.setAttribute("disabled",""),o.setAttribute("class","list-group-item"),o.setAttribute(i.evntType,i.evnt),a.appendChild(o)}e.appendChild(r),e.appendChild(a),document.body.appendChild(e),$(e).show(500)})}function removeSelected(t){RemSelected(),$(t.parentElement.parentElement).remove()}function RemSelected(){for(let t=0;t<selectedArr.length;t++)$(selectedArr[t]).remove();selectedArr.splice(0,selectedArr.length),rowArrange(),toplamHesapla_2(),toplamHesapla()}function rowArrange(){var t=document.getElementsByClassName("sepetRow");for(let R=0;R<t.length;R++){var e=R+1,r=t[R],a=r.getAttribute("data-rc");r.setAttribute("id","row_"+e),r.setAttribute("data-selected","0"),r.setAttribute("data-rc",e);var n=document.getElementById("product_name_"+a),i=$(r).find("input:checkbox")[0];i.setAttribute("data-row",e),n.setAttribute("id","product_name_"+e),n.setAttribute("name","product_name_"+e);var o=document.getElementById("spn_"+a);o.innerText=e,o.setAttribute("id","spn_"+e);var d=document.getElementById("product_id_"+a);d.setAttribute("id","product_id_"+e),d.setAttribute("name","product_id_"+e);var u=document.getElementById("is_manuel_"+a);u.setAttribute("id","is_manuel_"+e),u.setAttribute("name","is_manuel_"+e);var l=document.getElementById("is_karma_"+a);l.setAttribute("id","is_karma_"+e),l.setAttribute("name","is_karma_"+e);var c=document.getElementById("stock_id_"+a);c.setAttribute("id","stock_id_"+e),c.setAttribute("name","stock_id_"+e);var s=document.getElementById("is_production_"+a);s.setAttribute("id","is_production_"+e),s.setAttribute("name","is_production_"+e);var _=document.getElementById("is_virtual_"+a);_.setAttribute("id","is_virtual_"+e),_.setAttribute("name","is_virtual_"+e);var m=document.getElementById("row_uniq_id_"+a);m.setAttribute("id","row_uniq_id_"+e),m.setAttribute("name","row_uniq_id_"+e);var p=document.getElementById("cost_"+a);p.setAttribute("id","cost_"+e),p.setAttribute("name","cost_"+e);var A=document.getElementById("amount_"+a);A.setAttribute("id","amount_"+e),A.setAttribute("name","amount_"+e);var E=document.getElementById("price_"+a);E.setAttribute("id","price_"+e),E.setAttribute("name","price_"+e);var v=document.getElementById("stock_code_"+a);v.setAttribute("id","stock_code_"+e),v.setAttribute("name","stock_code_"+e);var b=document.getElementById("brand_name_"+a);b.setAttribute("id","brand_name_"+e),b.setAttribute("name","brand_name_"+e);var C=document.getElementById("main_unit_"+a);C.setAttribute("id","main_unit_"+e),C.setAttribute("name","main_unit_"+e);var I=document.getElementById("product_name_other_"+a);I.setAttribute("id","product_name_other_"+e),I.setAttribute("name","product_name_other_"+e);var y=document.getElementById("detail_info_extra_"+a);y.setAttribute("id","detail_info_extra_"+e),y.setAttribute("name","detail_info_extra_"+e);var h=document.getElementById("deliver_date_"+a);h.setAttribute("id","deliver_date_"+e),h.setAttribute("name","deliver_date_"+e);var T=document.getElementById("price_other_"+a);T.setAttribute("id","price_other_"+e),T.setAttribute("name","price_other_"+e);T=document.getElementById("other_money_"+a);T.setAttribute("id","other_money_"+e),T.setAttribute("name","other_money_"+e);var P=document.getElementById("row_nettotal_"+a);P.setAttribute("id","row_nettotal_"+e),P.setAttribute("name","row_nettotal_"+e);var w=document.getElementById("converted_sid_"+a);w.setAttribute("id","converted_sid_"+e),w.setAttribute("name","converted_sid_"+e);var g=document.getElementById("shelf_code_"+a);g.setAttribute("id","shelf_code_"+e),g.setAttribute("name","shelf_code_"+e);var D=document.getElementById("orderrow_currency_"+a);D.setAttribute("id","orderrow_currency_"+e),D.setAttribute("name","orderrow_currency_"+e);var S=document.getElementById("Tax_"+a);S.setAttribute("id","Tax_"+e),S.setAttribute("name","Tax_"+e);var O=document.getElementById("indirim1_"+a);O.setAttribute("id","indirim1_"+e),O.setAttribute("name","indirim1_"+e);var f=document.getElementById("description_"+a);f.setAttribute("id","description_"+e),f.setAttribute("name","description_"+e)}row_count=t.length,rowCount=t.length}function RowControlForVirtual(){var t=document.getElementsByClassName("sepetRow"),e=!1;for(let a=1;a<=t.length;a++){var r=document.getElementById("is_virtual_"+a);1==parseInt(r.value)&&(e=!0)}e?(document.getElementById("siparis").setAttribute("disabled","true"),document.getElementById("sevkiyat").setAttribute("disabled","true"),$(document.getElementById("snl_teklif")).click()):(document.getElementById("siparis").removeAttribute("disabled"),document.getElementById("sevkiyat").removeAttribute("disabled"))}function getProductMultiUse(t,e,r){function a(a){if(n=!1,window.XMLHttpRequest)try{n=new XMLHttpRequest}catch(t){n=!1}else if(window.ActiveXObject)try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){n=!1}}if(n){function o(){4==n.readyState&&200==n.status&&(JSON.parse(n.responseText.replace(/\u200B/g,"")),i=JSON.parse(n.responseText.replace(/\u200B/g,"")))}n.open("post",a+"&xmlhttp=1",!1),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("pragma","nocache"),n.send("keyword="+t+"&userid="+generalParamsSatis.userData.user_id+"&dsn2="+generalParamsSatis.dataSources.dsn2+"&dsn1="+generalParamsSatis.dataSources.dsn1+"&dsn3="+generalParamsSatis.dataSources.dsn3+"&price_catid="+r+"&comp_id="+e),o()}}var n,i=new Object;return a("/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=getProduct"),i}function getProductMultiUseA(t,e,r,a=0){function n(n){if(i=!1,window.XMLHttpRequest)try{i=new XMLHttpRequest}catch(t){i=!1}else if(window.ActiveXObject)try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){i=!1}}if(i){function d(){4==i.readyState&&200==i.status&&(JSON.parse(i.responseText.replace(/\u200B/g,"")),o=JSON.parse(i.responseText.replace(/\u200B/g,"")))}i.open("post",n+"&xmlhttp=1",!1),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.setRequestHeader("pragma","nocache"),i.send("keyword="+t+"&question_id="+a+"&userid="+generalParamsSatis.userData.user_id+"&dsn2="+generalParamsSatis.dataSources.dsn2+"&dsn1="+generalParamsSatis.dataSources.dsn1+"&dsn3="+generalParamsSatis.dataSources.dsn3+"&price_catid="+r+"&comp_id="+e+"&dsn="+generalParamsSatis.dataSources.dsn),d()}}var i,o=new Object;return n("/AddOns/Partner/satis/cfc/hizli_satis.cfc?method=getProductListpbs"),o}function openPriceListPartner(t,e,r,a){var n="";moneyArr.forEach(function(t,e){console.log(t.MONEY),n+=t.MONEY+"="+t.RATE2+"&"});var i="index.cfm?fuseaction=objects.emptypopup_price_history_partner&"+n+"sepet_process_type=-1&product_id="+t+"&stock_id="+e+"&pid="+t+"&product_name=&unit="+r+"&row_id=0&company_id="+a;openBoxDraggable(i)}function searchCode(t,e){var r=t.value;$(".stockkodu").filter(function(){$(this).parent().parent().parent().toggle($(this).val().toLowerCase().indexOf(r.toLowerCase())>-1)})}function searchName(t,e){var r=t.value;$(".urunadi").filter(function(){$(this).parent().parent().parent().toggle($(this).val().toLowerCase().indexOf(r.toLowerCase())>-1)})}function moveRow(t,e){if(1!=t){var r=$("#row_"+t).attr("data-producttype"),a=$("#row_"+e).attr("data-producttype"),n=$("#product_id_"+t).val(),i=$("#stock_id_"+t).val(),o=$("#is_virtual_"+t).val(),d=$("#shelf_code_"+t).val(),u=$("#cost_"+t).val(),l=$("#is_production_"+t).val(),c=$("#row_uniq_id_"+t).val(),s=$("#stock_code_"+t).val(),_=$("#product_name_"+t).val(),m=$("#brand_name_"+t).val(),p=$("#department_name"+t).val(),A=$("#amount_"+t).val(),E=$("#main_unit_"+t).val(),v=$("#other_money_"+t).val(),b=$("#price_other_"+t).val(),C=$("#price_"+t).val(),I=$("#indirim1_"+t).val(),y=$("#row_nettotal_"+t).val(),h=$("#detail_info_extra_"+t).val(),T=$("#deliver_date_"+t).val(),P=$("#Tax_"+t).val(),w=$("#orderrow_currency_"+t).val(),g=$("#description_"+t).val(),D=$("#product_name_other_"+t).val(),S=$("#is_karma_"+t).val(),O=$("#product_id_"+e).val(),f=$("#stock_id_"+e).val(),R=$("#is_virtual_"+e).val(),N=$("#shelf_code_"+e).val(),B=$("#cost_"+e).val(),x=$("#is_production_"+e).val(),k=$("#row_uniq_id_"+e).val(),L=$("#stock_code_"+e).val(),U=$("#product_name_"+e).val(),M=$("#brand_name_"+e).val(),F=$("#department_name"+e).val(),H=$("#amount_"+e).val(),Y=$("#main_unit_"+e).val(),K=$("#other_money_"+e).val(),q=$("#price_other_"+e).val(),G=$("#price_"+e).val(),W=$("#indirim1_"+e).val(),j=$("#row_nettotal_"+e).val(),J=$("#detail_info_extra_"+e).val(),V=$("#deliver_date_"+e).val(),X=$("#Tax_"+e).val(),z=$("#orderrow_currency_"+e).val(),Q=$("#description_"+e).val(),Z=$("#product_name_other_"+e).val(),tt=$("#is_karma_"+e).val();$("#product_id_"+e).val(n),$("#product_id_"+t).val(O),$("#stock_id_"+e).val(i),$("#stock_id_"+t).val(f),$("#is_virtual_"+e).val(o),$("#is_virtual_"+t).val(R),$("#shelf_code_"+e).val(d),$("#shelf_code_"+t).val(N),$("#cost_"+e).val(u),$("#cost_"+t).val(B),$("#is_production_"+e).val(l),$("#is_production_"+t).val(x),$("#is_karma_"+e).val(S),$("#is_karma_"+t).val(tt),$("#row_uniq_id_"+e).val(c),$("#row_uniq_id_"+t).val(k),$("#stock_code_"+e).val(s),$("#stock_code_"+t).val(L),$("#product_name_"+e).val(_),$("#product_name_"+t).val(U),$("#brand_name_"+e).val(m),$("#brand_name_"+t).val(M),$("#department_name"+e).val(p),$("#department_name"+t).val(F),$("#amount_"+e).val(A),$("#amount_"+t).val(H),$("#main_unit_"+e).val(E),$("#main_unit_"+t).val(Y),$("#other_money_"+e).val(v),$("#other_money_"+t).val(K),$("#price_other_"+e).val(b),$("#price_other_"+t).val(q),$("#price_"+e).val(C),$("#price_"+t).val(G),$("#indirim1_"+e).val(I),$("#indirim1_"+t).val(W),$("#row_nettotal_"+e).val(y),$("#row_nettotal_"+t).val(j),$("#detail_info_extra_"+e).val(h),$("#detail_info_extra_"+t).val(J),$("#Tax_"+e).val(P),$("#Tax_"+t).val(X),$("#deliver_date_"+e).val(T),$("#deliver_date_"+t).val(V),$("#orderrow_currency_"+e).val(w),$("#orderrow_currency_"+t).val(z),$("#description_"+e).val(g),$("#description_"+t).val(Q),$("#product_name_other_"+e).val(D),$("#product_name_other_"+t).val(Z),document.getElementById("row_"+e).setAttribute("data-producttype",r),document.getElementById("row_"+t).setAttribute("data-producttype",a),hesapla("price",t),hesapla("price",e)}}function GenerateUniqueId(){var t=new Date,e=t.toISOString().split("T")[0],r=t.toISOString().split("T")[1],a=e.replaceAll("-",""),n=r.replaceAll(":","");n=n.replaceAll(".",""),console.log(n);var i="PBS"+generalParamsSatis.userData.user_id+a+n;return i}function getSetNum(t){var e=t.value;0==e.length?t.value=commaSplit(0):t.value=commaSplit(e)}function CheckSatilabilir(){var t=new Array;for(let d=1;d<=row_count;d++){var e=document.getElementById("stock_id_"+d).value,r=document.getElementById("amount_"+d).value,a=parseFloat(filterNum(r)),n=document.getElementById("row_"+d),i=t.findIndex(t=>t.STOCK_ID==e);if(-1==i){var o=new Object;o.STOCK_ID=e,o.MIKTAR=a,t.push(o)}else t[i].MIKTAR+=a}for(let r=0;r<t.length;r++){var d=wrk_query("SELECT ISNULL("+generalParamsSatis.dataSources.dsn2+".GET_SATILABILIR_STOCK("+t[r].STOCK_ID+"),0) as SATILABILIR","dsn2"),u=parseFloat(d.SATILABILIR[0]);console.log(u);var l=!1;u<t[r].MIKTAR&&(l=!0);for(let a=1;a<=row_count;a++){e=document.getElementById("stock_id_"+a).value,n=document.getElementById("row_"+a);e==t[r].STOCK_ID&&(l?n.setAttribute("style","background:#ff5959"):n.removeAttribute("style"),console.log("miktar yokrow_"+a+"DD="+l))}}}function openPump(t){windowopen("index.cfm?fuseaction=product.emptypopup_virtual_main_partner&type=3&id="+t+"&company_id="+CompanyData.COMPANY_ID+"&PRICE_CATID="+CompanyData.PRICE_CAT,"wwide")}function FiyatTalepKontrol(t=0){if(0!=t){var e=$("#row_uniq_id_"+t).val(),r=$("#orderrow_currency_"+t).val();if(1==parseInt(r)){console.log(e);var a="SELECT * FROM PBS_OFFER_ROW_PRICE_OFFER WHERE UNIQUE_RELATION_ID='"+e+"'",n=wrk_query(a,"dsn3");if(1==parseInt(n.IS_ACCCEPTED[0])){var i=document.getElementById("row_"+t);i.setAttribute("style","background:#ffd70069"),i.setAttribute("data-priceOffer","1")}}}else for(let t=1;t<=row_count;t++){e=$("#row_uniq_id_"+t).val(),r=$("#orderrow_currency_"+t).val();if(1==parseInt(r)){console.log(e);a="SELECT * FROM PBS_OFFER_ROW_PRICE_OFFER WHERE UNIQUE_RELATION_ID='"+e+"'",n=wrk_query(a,"dsn3");if(1==parseInt(n.IS_ACCCEPTED[0])){i=document.getElementById("row_"+t);i.setAttribute("style","background:#ffd70069"),i.setAttribute("data-priceOffer","1")}console.log(n)}}}function setFiyatA(t,e,r,a){$("#price_"+t).val(e),$("#other_money_"+t).val(r),$("orderrow_currency_"+t).val(-6),hesapla("price",t),closeBoxDraggable(a)}function ConvertRealProduct(pid,rwid){if("0"==document.getElementById("is_virtual_"+rwid).value){openBoxDraggable("index.cfm?fuseaction=project.emptypopup_mini_tools&Message=Gerçek Ürüne Dönüşmüştür&tool_type=showMessage&AlertType=danger","1453162606");var e=setTimeout(function(){closeBoxDraggable("1453162606")},5e3)}$.ajax({url:"index.cfm?fuseaction=objects.emptypopup_createRealProductPbs&ajax=1&ajax_box_page=1&isAjax=1&VIRTUAL_PRODUCT_ID="+pid+"&ROW_ID="+rwid,beforeSend:function(){openBoxDraggable("index.cfm?fuseaction=project.emptypopup_mini_tools&tool_type=showMessage&AlertType=warning","1453162606")},success:function(retDat){closeBoxDraggable("1453162606"),console.log(retDat);var O=JSON.parse(retDat.trim());console.log(O);var PidE=eval("O[0].PRODUCT_ID_"+pid),SidE=eval("O[0].STOCK_ID_"+pid),PCODE=eval("O[0].PRODUCT_CODE_"+pid);document.getElementById("product_id_"+rwid).value=PidE,document.getElementById("stock_id_"+rwid).value=SidE,document.getElementById("is_virtual_"+rwid).value=0,document.getElementById("stock_code_"+rwid).value=PCODE}})}function getKarmaProducts(t,e){var r=17,a="";a+="select S.PRODUCT_NAME,S.PRODUCT_ID,S.PRODUCT_CODE,S.STOCK_ID,S.TAX,S.TAX_PURCHASE,KP.PRODUCT_AMOUNT,PB.BRAND_NAME,PC.DETAIL,PU.MAIN_UNIT,KP.KARMA_PRODUCT_ID,CASE WHEN (",a+="  SELECT TOP 1 PROPERTY1 FROM "+generalParamsSatis.dataSources.dsn3+".PRODUCT_INFO_PLUS WHERE",a+=" PRODUCT_INFO_PLUS.PRODUCT_ID = S.PRODUCT_ID ORDER BY PROPERTY1 DESC) ='MANUEL' THEN 1 ELSE 0 END AS IS_MANUEL,",a+="( SELECT TOP 1 PCE.DISCOUNT_RATE FROM "+generalParamsSatis.dataSources.dsn1+".PRODUCT P, "+generalParamsSatis.dataSources.dsn3+".PRICE_CAT_EXCEPTIONS PCE LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".PRICE_CAT PC ON PC.PRICE_CATID = PCE.PRICE_CATID",a+=" WHERE (PCE.PRODUCT_ID = P.PRODUCT_ID OR PCE.PRODUCT_ID IS NULL ) AND ( PCE.BRAND_ID = P.BRAND_ID OR PCE.BRAND_ID IS NULL) AND ( PCE.PRODUCT_CATID = P.PRODUCT_CATID OR PCE.PRODUCT_CATID IS NULL)",a+=" AND P.PRODUCT_ID = S.PRODUCT_ID AND ISNULL(PC.IS_SALES,0) = 1 AND PCE.ACT_TYPE NOT IN (2,4) AND  PC.PRICE_CATID = "+r+" ORDER BY PCE.PRODUCT_ID DESC, PCE.PRODUCT_CATID DESC,PCE.BRAND_ID DESC) AS DISCOUNT",a+=",( SELECT TOP 1 IR.PRICE-(IR.DISCOUNTTOTAL/2) AS PRICE FROM "+generalParamsSatis.dataSources.dsn2+". INVOICE I LEFT JOIN "+generalParamsSatis.dataSources.dsn2+".INVOICE_ROW IR ON IR.INVOICE_ID = I.INVOICE_ID WHERE ISNULL(I.PURCHASE_SALES,0) = 0 AND",a+=" IR.PRODUCT_ID = S.PRODUCT_ID AND I.PROCESS_CAT<>35 ORDER BY I.INVOICE_DATE DESC) AS LAST_COST ,ISNULL(GPA.PRICE,KP.SALES_PRICE) AS PRICE ,ISNULL(GPA.MONEY,KP.MONEY) AS MONEY",a+=" from "+generalParamsSatis.dataSources.dsn1+".KARMA_PRODUCTS AS KP LEFT JOIN "+generalParamsSatis.dataSources.dsn3+".STOCKS AS S ON S.PRODUCT_ID=KP.PRODUCT_ID LEFT JOIN "+generalParamsSatis.dataSources.dsn1+".PRODUCT_UNIT AS PU ON PU.PRODUCT_ID=S.PRODUCT_ID AND PU.IS_MAIN=1 LEFT JOIN",a+=" (SELECT P.UNIT,P.PRICE,P.PRICE_KDV,P.PRODUCT_ID,P.MONEY,P.PRICE_CATID,P.CATALOG_ID,P.PRICE_DISCOUNT FROM "+generalParamsSatis.dataSources.dsn3+".PRICE P, "+generalParamsSatis.dataSources.dsn3+".PRODUCT PR WHERE P.PRODUCT_ID = PR.PRODUCT_ID AND P.PRICE_CATID = "+r,a+=" AND ( P.STARTDATE <= GETDATE() AND ( P.FINISHDATE >=GETDATE() OR P.FINISHDATE IS NULL)) AND ISNULL(P.SPECT_VAR_ID, 0) = 0 ) AS GPA ON GPA.PRODUCT_ID = S.PRODUCT_ID AND GPA.UNIT = PU.PRODUCT_UNIT_ID ",a+=" LEFT JOIN workcube_metosan_1.PRODUCT_BRANDS AS PB ON PB.BRAND_ID=S.BRAND_ID LEFT JOIN workcube_metosan_1.PRODUCT_CAT AS PC ON PC.PRODUCT_CATID=S.PRODUCT_CATID",a+=" WHERE KP.KARMA_PRODUCT_ID="+t;var n=wrk_query(a,"dsn3");console.log(n);for(let t=0;t<n.recordcount;t++)AddRow(n.PRODUCT_ID[t],n.STOCK_ID[t],n.PRODUCT_CODE[t],n.BRAND_NAME[t],0,n.PRODUCT_AMOUNT[t],n.PRICE[t],n.PRODUCT_NAME[t],n.TAX[t],n.DISCOUNT[t],n.DETAIL[t],"",n.MONEY[t],n.PRICE[t],-6,n.IS_MANUEL[t],n.LAST_COST[t],n.MAIN_UNIT[t],"","",0,"","",0,"","","",0,0,0,1)}var HataArr=[],row_count=0,rwww="",rwwwx="",rwwwxy="",selectedCount=0,rowCount=0,tempProductData="",selectedArr=[],selectedMoney="",CompanyData=new Object;$(document).ready(function(){setDoom(),"upd"==getParameterByName("event")&&CalisanKontrolPbs()});var elks="";